# å›¾åƒå±æ€§

> æ‹¿åˆ°ä¸€å¼ å›¾åƒï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŸ¥çœ‹å®ƒçš„å±æ€§â€”â€”å¤šé«˜å¤šå®½ï¼Ÿå‡ ä¸ªé€šé“ï¼Ÿä»€ä¹ˆæ•°æ®ç±»å‹ï¼Ÿè¿™äº›ä¿¡æ¯å†³å®šäº†ä½ åç»­æ‰€æœ‰æ“ä½œçš„æ–¹å¼ã€‚å°±åƒåŒ»ç”Ÿçœ‹ç—…å…ˆé‡ä½“æ¸©è¡€å‹ä¸€æ ·ï¼Œå›¾åƒå¤„ç†ä¹Ÿè¦å…ˆ"ä½“æ£€"ã€‚

---

## ğŸ“– ç†è®ºéƒ¨åˆ†

### 1. ä¸ºä»€ä¹ˆè¦äº†è§£å›¾åƒå±æ€§ï¼Ÿ

åœ¨å®é™…å¼€å‘ä¸­ï¼Œä½ ä¼šé‡åˆ°å„ç§å„æ ·çš„å›¾åƒï¼š

- ä»æ‘„åƒå¤´è·å–çš„å®æ—¶ç”»é¢ â†’ å¯èƒ½æ˜¯ 640Ã—480 æˆ– 1920Ã—1080
- ä»ç½‘ä¸Šä¸‹è½½çš„ç…§ç‰‡ â†’ å°ºå¯¸ä¸ç¡®å®š
- æ¨¡å‹è¦æ±‚çš„è¾“å…¥ â†’ å¿…é¡»æ˜¯ 224Ã—224Ã—3 çš„ float32
- ç°åº¦å›¾è¿˜æ˜¯å½©è‰²å›¾ï¼Ÿ â†’ å†³å®šäº†é€šé“æ“ä½œæ–¹å¼

**ä¸æ£€æŸ¥å±æ€§å°±å¼€å§‹å¤„ç†ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ï¼š**

```python
# âŒ ä¸æ£€æŸ¥å°±æ“ä½œ â†’ éšæ—¶å¯èƒ½å´©æºƒ
def process(img):
    b, g, r = cv2.split(img)    # å¦‚æœæ˜¯ç°åº¦å›¾ï¼Œè¿™é‡Œå°±æŠ¥é”™äº†ï¼
    return cv2.merge([r, g, b])

# âœ… å…ˆæ£€æŸ¥å†æ“ä½œ â†’ ç¨³å®šå¯é 
def process(img):
    if img.ndim == 2:
        print("è¿™æ˜¯ç°åº¦å›¾ï¼Œä¸éœ€è¦é€šé“æ“ä½œ")
        return img
    b, g, r = cv2.split(img)
    return cv2.merge([r, g, b])
```

---

### 2. æ ¸å¿ƒå±æ€§è¯¦è§£

#### 2.1 shapeï¼šå½¢çŠ¶ï¼ˆæœ€é‡è¦ï¼ï¼‰

```python
import cv2
import numpy as np

# å½©è‰²å›¾åƒ
color = np.zeros((480, 640, 3), dtype=np.uint8)
print(color.shape)      # (480, 640, 3)
#                          â†‘     â†‘    â†‘
#                        é«˜åº¦   å®½åº¦  é€šé“æ•°

height = color.shape[0]     # 480 â€” é«˜åº¦ï¼ˆè¡Œæ•°ï¼‰
width = color.shape[1]      # 640 â€” å®½åº¦ï¼ˆåˆ—æ•°ï¼‰
channels = color.shape[2]   # 3   â€” é€šé“æ•°

# æ›´ä¼˜é›…çš„å†™æ³•ï¼ˆæ¨èï¼ï¼‰
h, w, c = color.shape
print(f"é«˜åº¦={h}, å®½åº¦={w}, é€šé“æ•°={c}")

# ç°åº¦å›¾åƒï¼ˆåªæœ‰2ä¸ªç»´åº¦ï¼‰
gray = np.zeros((480, 640), dtype=np.uint8)
print(gray.shape)       # (480, 640)
# gray.shape[2]         # âŒ IndexError! ç°åº¦å›¾æ²¡æœ‰ç¬¬3ç»´
```

**é€šç”¨çš„è·å–æ–¹å¼ï¼ˆç°åº¦/å½©è‰²éƒ½é€‚ç”¨ï¼‰ï¼š**

```python
def get_image_info(img):
    """å®‰å…¨åœ°è·å–å›¾åƒä¿¡æ¯"""
    h, w = img.shape[:2]                          # å‰ä¸¤ç»´ä¸€å®šæ˜¯é«˜å’Œå®½
    channels = img.shape[2] if img.ndim == 3 else 1  # ç°åº¦å›¾é€šé“æ•°ä¸º1
    return h, w, channels

# æµ‹è¯•
color = np.zeros((480, 640, 3), dtype=np.uint8)
gray = np.zeros((480, 640), dtype=np.uint8)

print(get_image_info(color))   # (480, 640, 3)
print(get_image_info(gray))    # (480, 640, 1)
```

```
shape è®°å¿†å›¾è§£ï¼š

å½©è‰²å›¾åƒ shape = (H, W, C):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          â”‚ â†• H (é«˜åº¦/è¡Œæ•°) = shape[0]
â”‚                          â”‚
â”‚         å›¾åƒå†…å®¹          â”‚
â”‚                          â”‚
â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†â”€â”€â”€â”€â”€ W (å®½åº¦/åˆ—æ•°) â”€â”€â”€â”€â†’  = shape[1]

  æ¯ä¸ªåƒç´  = [B, G, R]        C (é€šé“æ•°)    = shape[2]


ç°åº¦å›¾åƒ shape = (H, W):
  æ²¡æœ‰ç¬¬3ç»´ï¼åªæœ‰é«˜åº¦å’Œå®½åº¦
```

> âš ï¸ **æœ€å¸¸è§çš„æ··æ·†ï¼š** `shape` è¿”å›çš„æ˜¯ `(é«˜åº¦, å®½åº¦)`ï¼Œ**é«˜åº¦åœ¨å‰**ï¼ä½†æ—¥å¸¸è¯´çš„"åˆ†è¾¨ç‡"é€šå¸¸æ˜¯"å®½Ã—é«˜"ï¼ˆå¦‚ 1920Ã—1080ï¼‰ã€‚åƒä¸‡ä¸è¦æåäº†ã€‚

#### 2.2 dtypeï¼šæ•°æ®ç±»å‹

```python
# ä¸åŒç±»å‹çš„å›¾åƒ
uint8_img = np.zeros((100, 100), dtype=np.uint8)
float32_img = np.zeros((100, 100), dtype=np.float32)
float64_img = np.zeros((100, 100), dtype=np.float64)

print(uint8_img.dtype)     # uint8     â€” åƒç´ å€¼ 0~255
print(float32_img.dtype)   # float32   â€” åƒç´ å€¼é€šå¸¸ 0.0~1.0
print(float64_img.dtype)   # float64   â€” é«˜ç²¾åº¦æµ®ç‚¹
```

**å¸¸è§æ•°æ®ç±»å‹åŠç”¨é€”ï¼š**

| dtype | èŒƒå›´ | å­—èŠ‚ | ç”¨é€” |
|-------|------|------|------|
| `uint8` | 0 ~ 255 | 1 | **æ ‡å‡†å›¾åƒ**ï¼ˆOpenCV è¯»å–çš„é»˜è®¤ç±»å‹ï¼‰ |
| `int16` | -32768 ~ 32767 | 2 | å›¾åƒè¿ç®—ä¸­é—´ç»“æœï¼ˆé˜²æº¢å‡ºï¼‰ |
| `float32` | Â±3.4Ã—10Â³â¸ | 4 | **æ¨¡å‹è¾“å…¥**ï¼ˆå½’ä¸€åŒ–åçš„å›¾åƒï¼‰ |
| `float64` | Â±1.8Ã—10Â³â°â¸ | 8 | é«˜ç²¾åº¦è®¡ç®— |
| `bool` | True/False | 1 | æ©è†œ |

```python
# ç±»å‹å¯¹å†…å­˜çš„å½±å“
img_u8 = np.zeros((1080, 1920, 3), dtype=np.uint8)
img_f32 = np.zeros((1080, 1920, 3), dtype=np.float32)
img_f64 = np.zeros((1080, 1920, 3), dtype=np.float64)

print(f"uint8:   {img_u8.nbytes / 1024 / 1024:.1f} MB")    # 5.9 MB
print(f"float32: {img_f32.nbytes / 1024 / 1024:.1f} MB")   # 23.7 MBï¼ˆÃ—4ï¼‰
print(f"float64: {img_f64.nbytes / 1024 / 1024:.1f} MB")   # 47.5 MBï¼ˆÃ—8ï¼‰

# åŒæ ·ä¸€å¼  1080p å›¾åƒï¼Œfloat64 æ¯” uint8 å¤§ 8 å€ï¼
```

#### 2.3 sizeï¼šå…ƒç´ æ€»æ•°

```python
color = np.zeros((480, 640, 3), dtype=np.uint8)
gray = np.zeros((480, 640), dtype=np.uint8)

print(color.size)   # 921600 = 480 Ã— 640 Ã— 3
print(gray.size)    # 307200 = 480 Ã— 640

# size = æ‰€æœ‰ç»´åº¦ç›¸ä¹˜çš„æ€»å…ƒç´ æ•°
# æ³¨æ„ï¼šå¯¹äºå½©è‰²å›¾ï¼Œsize åŒ…å«æ‰€æœ‰é€šé“çš„å€¼
# åƒç´ æ•°é‡ = height Ã— width
pixel_count = color.shape[0] * color.shape[1]
print(f"åƒç´ æ•°é‡: {pixel_count}")    # 307200
```

#### 2.4 ndimï¼šç»´åº¦æ•°

```python
# ç”¨ ndim åˆ¤æ–­ç°åº¦/å½©è‰²
gray = np.zeros((480, 640), dtype=np.uint8)
color = np.zeros((480, 640, 3), dtype=np.uint8)
rgba = np.zeros((480, 640, 4), dtype=np.uint8)

print(gray.ndim)    # 2 â†’ ç°åº¦å›¾
print(color.ndim)   # 3 â†’ å½©è‰²å›¾
print(rgba.ndim)    # 3 â†’ ä¹Ÿæ˜¯3ï¼ˆè¦çœ‹ shape[2] åŒºåˆ†3é€šé“å’Œ4é€šé“ï¼‰
```

#### 2.5 å†…å­˜ç›¸å…³å±æ€§

```python
img = np.zeros((1080, 1920, 3), dtype=np.uint8)

print(f"itemsize: {img.itemsize} å­—èŠ‚")      # æ¯ä¸ªå…ƒç´ å ç”¨å­—èŠ‚
print(f"nbytes:   {img.nbytes} å­—èŠ‚")        # æ€»å†…å­˜å¤§å°
print(f"          {img.nbytes / 1024:.1f} KB")
print(f"          {img.nbytes / 1024 / 1024:.1f} MB")
```

---

### 3. å›¾åƒç±»å‹åˆ¤æ–­

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œä½ ç»å¸¸éœ€è¦åˆ¤æ–­å›¾åƒçš„ç±»å‹å¹¶åšç›¸åº”å¤„ç†ï¼š

```python
import cv2
import numpy as np

def describe_image(img):
    """å…¨é¢æè¿°å›¾åƒå±æ€§"""
    if img is None:
        print("  âŒ å›¾åƒä¸ºç©º (None)")
        return

    h, w = img.shape[:2]

    # åˆ¤æ–­å›¾åƒç±»å‹
    if img.ndim == 2:
        img_type = "ç°åº¦å›¾"
        channels = 1
    elif img.ndim == 3:
        channels = img.shape[2]
        if channels == 3:
            img_type = "å½©è‰²å›¾ (BGR)"
        elif channels == 4:
            img_type = "å¸¦é€æ˜é€šé“ (BGRA)"
        else:
            img_type = f"å¤šé€šé“å›¾ ({channels}é€šé“)"
    else:
        img_type = f"æœªçŸ¥ ({img.ndim}ç»´)"
        channels = "?"

    # åˆ¤æ–­æ•°æ®ç±»å‹
    if img.dtype == np.uint8:
        dtype_desc = "uint8 (æ ‡å‡†å›¾åƒ, 0~255)"
    elif img.dtype == np.float32:
        dtype_desc = "float32 (å½’ä¸€åŒ–, é€šå¸¸0.0~1.0)"
    elif img.dtype == np.float64:
        dtype_desc = "float64 (é«˜ç²¾åº¦æµ®ç‚¹)"
    else:
        dtype_desc = str(img.dtype)

    # è¾“å‡º
    print(f"  ç±»å‹:   {img_type}")
    print(f"  å°ºå¯¸:   {w} Ã— {h} (å®½Ã—é«˜)")
    print(f"  shape:  {img.shape}")
    print(f"  dtype:  {dtype_desc}")
    print(f"  é€šé“æ•°: {channels}")
    print(f"  åƒç´ æ•°: {h * w:,}")
    print(f"  å†…å­˜:   {img.nbytes / 1024:.1f} KB")

    if img.dtype in [np.uint8, np.float32, np.float64]:
        print(f"  å€¼åŸŸ:   [{img.min()}, {img.max()}]")

# ä½¿ç”¨ç¤ºä¾‹
gray = np.random.randint(0, 256, (480, 640), dtype=np.uint8)
color = np.random.randint(0, 256, (480, 640, 3), dtype=np.uint8)
normalized = color.astype(np.float32) / 255.0

print("ã€ç°åº¦å›¾ã€‘")
describe_image(gray)
print("\nã€å½©è‰²å›¾ã€‘")
describe_image(color)
print("\nã€å½’ä¸€åŒ–å›¾ã€‘")
describe_image(normalized)
```

---

### 4. OpenCV å¸¸ç”¨çš„å›¾åƒä¿¡æ¯è·å–

é™¤äº† NumPy å±æ€§ï¼ŒOpenCV è‡ªèº«ä¹Ÿæœ‰ä¸€äº›è·å–å›¾åƒä¿¡æ¯çš„æ–¹å¼ï¼š

```python
import cv2

img = cv2.imread("photo.jpg")
if img is None:
    exit()

# è·å–å°ºå¯¸ï¼ˆä¸¤ç§å¸¸è§æ–¹å¼ï¼‰
# æ–¹å¼1ï¼šä» shape è·å–ï¼ˆæ¨èï¼‰
h, w = img.shape[:2]

# æ–¹å¼2ï¼šOpenCV æœ‰äº›å‡½æ•°éœ€è¦ (å®½, é«˜) æ ¼å¼
size_wh = (w, h)                    # æ³¨æ„ï¼šå®½åœ¨å‰ï¼
center = (w // 2, h // 2)          # å›¾åƒä¸­å¿ƒç‚¹
```

```
shape vs OpenCV å‡½æ•°å‚æ•°çš„é¡ºåºå·®å¼‚ï¼š

NumPy/shape:    (é«˜åº¦, å®½åº¦)  = (H, W)    â†’ shape[:2]
OpenCV resize:  (å®½åº¦, é«˜åº¦)  = (W, H)    â†’ cv2.resize(img, (W, H))
OpenCV circle:  (x, y)       = (åˆ—, è¡Œ)   â†’ cv2.circle(img, (x, y), ...)

è¿™æ˜¯ OpenCV æœ€è®©äººå¤´ç–¼çš„åœ°æ–¹ä¹‹ä¸€ï¼
è®°å¿†æ–¹æ³•ï¼š
  - shape è¿”å›çš„æ˜¯ "è¡Œåˆ—" = "é«˜å®½"
  - OpenCV å‡½æ•°å‚æ•°æ˜¯ "åæ ‡" = "x,y" = "åˆ—è¡Œ" = "å®½é«˜"
```

---

## ğŸ’» ä»£ç å®æˆ˜

### å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒå±æ€§æ£€æµ‹å™¨

```python
# ===================================================================
# å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒå±æ€§æ£€æµ‹å™¨
# ç›®æ ‡ï¼šå…¨é¢æŒæ¡å›¾åƒå±æ€§çš„è·å–å’Œåº”ç”¨
# ===================================================================

import cv2
import numpy as np

# ---------- 1. åˆ›å»ºå„ç§ç±»å‹çš„å›¾åƒ ----------
print("=" * 55)
print("ğŸ¨ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæµ‹è¯•å›¾åƒ")
print("=" * 55)

images = {
    "ç°åº¦å›¾ (å°)":    np.random.randint(0, 256, (100, 150), dtype=np.uint8),
    "ç°åº¦å›¾ (720p)":  np.random.randint(0, 256, (720, 1280), dtype=np.uint8),
    "å½©è‰²å›¾ (VGA)":   np.random.randint(0, 256, (480, 640, 3), dtype=np.uint8),
    "å½©è‰²å›¾ (1080p)": np.random.randint(0, 256, (1080, 1920, 3), dtype=np.uint8),
    "BGRAå›¾ (å¸¦é€æ˜)": np.random.randint(0, 256, (200, 300, 4), dtype=np.uint8),
    "å½’ä¸€åŒ– float32":  np.random.rand(224, 224, 3).astype(np.float32),
}

print(f"  åˆ›å»ºäº† {len(images)} ç§æµ‹è¯•å›¾åƒ\n")

# ---------- 2. å±æ€§å¯¹æ¯”è¡¨ ----------
print("=" * 55)
print("ğŸ“Š ç¬¬äºŒæ­¥ï¼šå±æ€§å¯¹æ¯”")
print("=" * 55)

header = f"  {'åç§°':<16s} {'shape':<20s} {'ndim':>4s} {'dtype':>8s} {'å†…å­˜':>10s}"
print(header)
print("  " + "-" * 62)

for name, img in images.items():
    mem = f"{img.nbytes / 1024:.1f} KB" if img.nbytes < 1024*1024 else f"{img.nbytes / 1024 / 1024:.1f} MB"
    print(f"  {name:<16s} {str(img.shape):<20s} {img.ndim:>4d} {str(img.dtype):>8s} {mem:>10s}")

# ---------- 3. å›¾åƒç±»å‹åˆ¤æ–­ ----------
print("\n" + "=" * 55)
print("ğŸ” ç¬¬ä¸‰æ­¥ï¼šç±»å‹åˆ¤æ–­")
print("=" * 55)

def classify_image(img):
    """åˆ¤æ–­å›¾åƒç±»å‹"""
    if img is None:
        return "æ— æ•ˆå›¾åƒ"
    if img.ndim == 2:
        return "ç°åº¦å›¾"
    elif img.ndim == 3:
        c = img.shape[2]
        return {1: "å•é€šé“", 3: "å½©è‰²(BGR)", 4: "é€æ˜(BGRA)"}.get(c, f"{c}é€šé“")
    return f"æœªçŸ¥({img.ndim}ç»´)"

for name, img in images.items():
    print(f"  {name:<16s} â†’ {classify_image(img)}")

# ---------- 4. å°ºå¯¸ä¸åˆ†è¾¨ç‡ ----------
print("\n" + "=" * 55)
print("ğŸ“ ç¬¬å››æ­¥ï¼šå°ºå¯¸åˆ†æ")
print("=" * 55)

for name, img in images.items():
    h, w = img.shape[:2]
    pixels = h * w
    aspect = w / h

    # åˆ¤æ–­åˆ†è¾¨ç‡ç­‰çº§
    if pixels >= 1920 * 1080:
        level = "Full HD+"
    elif pixels >= 1280 * 720:
        level = "HD"
    elif pixels >= 640 * 480:
        level = "VGA"
    else:
        level = "ä½åˆ†è¾¨ç‡"

    print(f"  {name:<16s}: {w}Ã—{h}, {pixels:>9,}åƒç´ , "
          f"æ¯”ä¾‹={aspect:.2f}, {level}")

# ---------- 5. æ•°æ®ç±»å‹è½¬æ¢ ----------
print("\n" + "=" * 55)
print("ğŸ”„ ç¬¬äº”æ­¥ï¼šç±»å‹è½¬æ¢ç¤ºä¾‹")
print("=" * 55)

img = np.random.randint(0, 256, (100, 100, 3), dtype=np.uint8)
print(f"  åŸå§‹:     dtype={img.dtype}, èŒƒå›´=[{img.min()}, {img.max()}]")

# uint8 â†’ float32 å½’ä¸€åŒ–
normalized = img.astype(np.float32) / 255.0
print(f"  å½’ä¸€åŒ–:   dtype={normalized.dtype}, èŒƒå›´=[{normalized.min():.3f}, {normalized.max():.3f}]")

# float32 â†’ uint8 åå½’ä¸€åŒ–
restored = (normalized * 255).astype(np.uint8)
print(f"  åå½’ä¸€åŒ–: dtype={restored.dtype}, èŒƒå›´=[{restored.min()}, {restored.max()}]")

# éªŒè¯æ˜¯å¦ä¸€è‡´
print(f"  è½¬æ¢æ— æŸ? {np.array_equal(img, restored)}")

# ---------- 6. å†…å­˜é¢„ä¼° ----------
print("\n" + "=" * 55)
print("ğŸ’¾ ç¬¬å…­æ­¥ï¼šå†…å­˜é¢„ä¼°å·¥å…·")
print("=" * 55)

def estimate_memory(height, width, channels=3, dtype=np.uint8):
    """é¢„ä¼°å›¾åƒå†…å­˜å ç”¨"""
    bytes_per_elem = np.dtype(dtype).itemsize
    total = height * width * channels * bytes_per_elem
    if total < 1024:
        return f"{total} B"
    elif total < 1024 * 1024:
        return f"{total / 1024:.1f} KB"
    else:
        return f"{total / 1024 / 1024:.1f} MB"

# å¸¸è§åˆ†è¾¨ç‡çš„å†…å­˜å ç”¨
resolutions = [
    ("VGA     (640Ã—480)",   480, 640),
    ("HD      (1280Ã—720)",  720, 1280),
    ("FHD     (1920Ã—1080)", 1080, 1920),
    ("2K      (2560Ã—1440)", 1440, 2560),
    ("4K      (3840Ã—2160)", 2160, 3840),
]

print(f"\n  {'åˆ†è¾¨ç‡':<22s} {'uint8 å½©è‰²':>12s} {'float32 å½©è‰²':>14s} {'uint8 ç°åº¦':>12s}")
print("  " + "-" * 62)
for name, h, w in resolutions:
    u8c = estimate_memory(h, w, 3, np.uint8)
    f32c = estimate_memory(h, w, 3, np.float32)
    u8g = estimate_memory(h, w, 1, np.uint8)
    print(f"  {name:<22s} {u8c:>12s} {f32c:>14s} {u8g:>12s}")

# ---------- 7. shape é¡ºåºé™·é˜± ----------
print("\n" + "=" * 55)
print("âš ï¸ ç¬¬ä¸ƒæ­¥ï¼šshape é¡ºåºé™·é˜±")
print("=" * 55)

img = np.zeros((480, 640, 3), dtype=np.uint8)
h, w = img.shape[:2]

print(f"  img.shape = {img.shape}")
print(f"  é«˜åº¦ (H) = shape[0] = {h}")
print(f"  å®½åº¦ (W) = shape[1] = {w}")
print(f"")
print(f"  NumPy shape:     (é«˜åº¦, å®½åº¦)  = ({h}, {w})")
print(f"  OpenCV resize:   (å®½åº¦, é«˜åº¦)  = ({w}, {h})")
print(f"  æ—¥å¸¸è¯´æ³•:        å®½Ã—é«˜         = {w}Ã—{h}")
print(f"")
print(f"  âš ï¸  ä¸‰è€…é¡ºåºéƒ½ä¸åŒï¼æ³¨æ„åŒºåˆ†ï¼")

print("\nâœ… å›¾åƒå±æ€§æ£€æµ‹ç»ƒä¹ å®Œæˆï¼")
```

**è¿è¡Œè¾“å‡ºç¤ºä¾‹ï¼š**

```
=======================================================
ğŸ“Š ç¬¬äºŒæ­¥ï¼šå±æ€§å¯¹æ¯”
=======================================================
  åç§°              shape                ndim    dtype       å†…å­˜
  --------------------------------------------------------------
  ç°åº¦å›¾ (å°)       (100, 150)              2    uint8    14.6 KB
  ç°åº¦å›¾ (720p)     (720, 1280)             2    uint8   900.0 KB
  å½©è‰²å›¾ (VGA)      (480, 640, 3)           3    uint8   900.0 KB
  å½©è‰²å›¾ (1080p)    (1080, 1920, 3)         3    uint8     5.9 MB
  BGRAå›¾ (å¸¦é€æ˜)   (200, 300, 4)           3    uint8   234.4 KB
  å½’ä¸€åŒ– float32    (224, 224, 3)           3  float32   588.0 KB

=======================================================
ğŸ’¾ ç¬¬å…­æ­¥ï¼šå†…å­˜é¢„ä¼°å·¥å…·
=======================================================

  åˆ†è¾¨ç‡                 uint8 å½©è‰²  float32 å½©è‰²   uint8 ç°åº¦
  --------------------------------------------------------------
  VGA     (640Ã—480)       900.0 KB       3.5 MB     300.0 KB
  HD      (1280Ã—720)        2.6 MB      10.5 MB     900.0 KB
  FHD     (1920Ã—1080)       5.9 MB      23.7 MB       2.0 MB
  4K      (3840Ã—2160)      23.7 MB      94.9 MB       7.9 MB

=======================================================
âš ï¸ ç¬¬ä¸ƒæ­¥ï¼šshape é¡ºåºé™·é˜±
=======================================================
  img.shape = (480, 640, 3)
  é«˜åº¦ (H) = shape[0] = 480
  å®½åº¦ (W) = shape[1] = 640

  NumPy shape:     (é«˜åº¦, å®½åº¦)  = (480, 640)
  OpenCV resize:   (å®½åº¦, é«˜åº¦)  = (640, 480)
  æ—¥å¸¸è¯´æ³•:        å®½Ã—é«˜         = 640Ã—480

  âš ï¸  ä¸‰è€…é¡ºåºéƒ½ä¸åŒï¼æ³¨æ„åŒºåˆ†ï¼
```

---

## ğŸš¨ å¸¸è§é—®é¢˜ä¸æ˜“é”™ç‚¹

### Q1: shape è¿”å› (H, W) è¿˜æ˜¯ (W, H)ï¼Ÿ

```python
# shape å§‹ç»ˆè¿”å› (é«˜åº¦, å®½åº¦) = (è¡Œæ•°, åˆ—æ•°)
img = np.zeros((480, 640, 3), dtype=np.uint8)
print(img.shape)   # (480, 640, 3) â†’ é«˜=480, å®½=640

# ä½† OpenCV çš„å¾ˆå¤šå‡½æ•°å‚æ•°è¦ (å®½, é«˜)ï¼š
# cv2.resize(img, (new_width, new_height))   â† å®½åœ¨å‰ï¼
# cv2.circle(img, (x, y), radius, color)     â† x(åˆ—)åœ¨å‰ï¼

# è®°å¿†æ–¹æ³•ï¼š
# shape = è¡Œåˆ— = é«˜å®½ = YX
# OpenCVå‡½æ•° = åæ ‡ = XY = å®½é«˜
```

### Q2: å¦‚ä½•å®‰å…¨åœ°è·å–é€šé“æ•°ï¼Ÿ

```python
# âŒ ä¸å®‰å…¨ï¼šç°åº¦å›¾æ²¡æœ‰ shape[2]
# channels = img.shape[2]   # ç°åº¦å›¾æŠ¥é”™ï¼

# âœ… å®‰å…¨å†™æ³•
channels = img.shape[2] if img.ndim == 3 else 1

# æˆ–è€…ç”¨ len(img.shape)
if len(img.shape) == 2:
    channels = 1
else:
    channels = img.shape[2]
```

### Q3: dtype ä¸å¯¹å¯¼è‡´æ˜¾ç¤ºå¼‚å¸¸ï¼Ÿ

```python
# float å›¾åƒç”¨ imshow æ˜¾ç¤ºçš„è§„åˆ™ï¼š
# - float èŒƒå›´åº”è¯¥æ˜¯ 0.0~1.0ï¼ˆè¶…å‡ºéƒ¨åˆ†ä¼šè¢«æˆªæ–­ï¼‰
# - uint8 èŒƒå›´æ˜¯ 0~255

# âŒ float èŒƒå›´ 0~255ï¼Œæ˜¾ç¤ºå…¨ç™½
float_img = np.ones((100, 100), dtype=np.float32) * 200
# cv2.imshow("Wrong", float_img)    # å…¨ç™½ï¼å› ä¸º >1.0 çš„éƒ½æˆªæ–­ä¸ºç™½è‰²

# âœ… å…ˆå½’ä¸€åŒ–åˆ° 0~1
# cv2.imshow("Correct", float_img / 255.0)

# âœ… æˆ–è½¬å› uint8
# cv2.imshow("Correct", float_img.astype(np.uint8))
```

### Q4: å›¾åƒå¤ªå¤§å†…å­˜ä¸å¤Ÿï¼Ÿ

```python
# 4K å½©è‰²å›¾ float32 éœ€è¦ 95MBï¼Œå¤„ç†å¤šå¼ å°±å®¹æ˜“çˆ†å†…å­˜

# è§£å†³ç­–ç•¥ï¼š
# 1. ç¼©å°å›¾åƒ
img_small = cv2.resize(img, (img.shape[1]//2, img.shape[0]//2))

# 2. ç”¨ uint8 ä»£æ›¿ floatï¼ˆçœ 4 å€å†…å­˜ï¼‰

# 3. å¤„ç†å®ŒåŠæ—¶é‡Šæ”¾
del large_image

# 4. ä½¿ç”¨ç°åº¦å›¾ï¼ˆçœ 3 å€å†…å­˜ï¼‰
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
```

---

## ğŸ¯ æ€»ç»“

æœ¬èŠ‚å­¦ä¹ äº† OpenCV å›¾åƒçš„å±æ€§ï¼š

âœ… **shape**ï¼š`(H, W, C)` æˆ– `(H, W)`ï¼Œé«˜åº¦åœ¨å‰å®½åº¦åœ¨å
âœ… **dtype**ï¼šé€šå¸¸ `uint8`(0~255) æˆ– `float32`(0.0~1.0)
âœ… **ndim**ï¼š2=ç°åº¦ï¼Œ3=å½©è‰²/BGRA
âœ… **size**ï¼šå…ƒç´ æ€»æ•°ï¼ˆå«æ‰€æœ‰é€šé“ï¼‰
âœ… **nbytes**ï¼šæ€»å†…å­˜å ç”¨ï¼ˆå­—èŠ‚ï¼‰
âœ… **ç±»å‹åˆ¤æ–­**ï¼šç”¨ `ndim` å’Œ `shape[2]` åŒºåˆ†ç°åº¦/å½©è‰²/é€æ˜
âœ… **é¡ºåºé™·é˜±**ï¼šshape=(é«˜,å®½)ï¼ŒOpenCVå‡½æ•°=(å®½,é«˜)ï¼Œæ—¥å¸¸è¯´æ³•=å®½Ã—é«˜

> ğŸ”‘ **æ ¸å¿ƒè¦ç‚¹ï¼š** æ‹¿åˆ°å›¾åƒç¬¬ä¸€æ­¥æ°¸è¿œæ˜¯ `print(img.shape, img.dtype)`ã€‚shape çš„é¡ºåºæ˜¯ **(é«˜åº¦, å®½åº¦)**ï¼Œè¿™å’Œ OpenCV å‡½æ•°å‚æ•°çš„ **(å®½åº¦, é«˜åº¦)** æ˜¯åçš„â€”â€”è¿™æ˜¯æ–°æ‰‹çŠ¯é”™ç‡æœ€é«˜çš„åœ°æ–¹ï¼

**ä¸‹ä¸€æ­¥ï¼š**
ğŸ‘‰ [05 - åƒç´ æ“ä½œ](../05-åƒç´ æ“ä½œ/åƒç´ æ“ä½œ.md)

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [OpenCV-Python å›¾åƒåŸºæœ¬æ“ä½œ](https://docs.opencv.org/4.x/d3/df2/tutorial_py_basic_ops.html)
- [NumPy æ•°ç»„å±æ€§](https://numpy.org/doc/stable/reference/arrays.ndarray.html#array-attributes)
