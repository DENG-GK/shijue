# å¸¸ç”¨å‡½æ•°

> NumPy æä¾›äº†ä¸°å¯Œçš„å·¥å…·å‡½æ•°ï¼Œæ¶µç›–æ’åºã€æœç´¢ã€é›†åˆè¿ç®—ã€æ–‡ä»¶è¯»å†™ç­‰ã€‚è¿™äº›å‡½æ•°åœ¨æ•°æ®å¤„ç†å’Œå›¾åƒåˆ†æä¸­ç»å¸¸ç”¨åˆ°ï¼ŒæŒæ¡å®ƒä»¬èƒ½è®©ä½ äº‹åŠåŠŸå€ã€‚

---

## ğŸ“– ç†è®ºéƒ¨åˆ†

### 1. æ’åºå‡½æ•°

æ’åºåœ¨æ•°æ®åˆ†æä¸­éå¸¸åŸºç¡€â€”â€”æ¯”å¦‚æŒ‰ç½®ä¿¡åº¦æ’åºæ£€æµ‹ç»“æœã€æ‰¾å‡ºæœ€äº®çš„åƒç´ ç­‰ã€‚

#### 1.1 np.sort()ï¼šæ’åº

```python
import numpy as np

arr = np.array([50, 10, 80, 30, 90, 20])

# è¿”å›æ’åºåçš„æ–°æ•°ç»„ï¼ˆä¸ä¿®æ”¹åŸæ•°ç»„ï¼‰
sorted_arr = np.sort(arr)
print(sorted_arr)   # [10 20 30 50 80 90]
print(arr)          # [50 10 80 30 90 20]  åŸæ•°ç»„æ²¡å˜

# é™åºæ’åºï¼ˆæ²¡æœ‰ç›´æ¥å‚æ•°ï¼Œå…ˆæ’å†åè½¬ï¼‰
desc = np.sort(arr)[::-1]
print(desc)   # [90 80 50 30 20 10]

# åŸåœ°æ’åºï¼ˆä¿®æ”¹åŸæ•°ç»„ï¼‰
arr.sort()
print(arr)    # [10 20 30 50 80 90]  åŸæ•°ç»„è¢«æ”¹äº†
```

#### 1.2 äºŒç»´æ•°ç»„æ’åº

```python
matrix = np.array([
    [50, 10, 80],
    [30, 90, 20],
    [70, 40, 60]
])

# æ¯è¡Œæ’åºï¼ˆaxis=1ï¼Œæ²¿åˆ—æ–¹å‘ï¼‰
print(np.sort(matrix, axis=1))
# [[10 50 80]
#  [20 30 90]
#  [40 60 70]]

# æ¯åˆ—æ’åºï¼ˆaxis=0ï¼Œæ²¿è¡Œæ–¹å‘ï¼‰
print(np.sort(matrix, axis=0))
# [[30 10 20]
#  [50 40 60]
#  [70 90 80]]
```

#### 1.3 np.argsort()ï¼šè¿”å›æ’åºåçš„ç´¢å¼•

`argsort()` ä¸è¿”å›æ’åºåçš„å€¼ï¼Œè€Œæ˜¯è¿”å›**æ’åºåçš„ç´¢å¼•**â€”â€”è¿™åœ¨å¾ˆå¤šåœºæ™¯ä¸­æ›´æœ‰ç”¨ï¼š

```python
scores = np.array([0.75, 0.92, 0.31, 0.88, 0.56])
class_names = np.array(["cat", "dog", "bird", "person", "car"])

# è·å–æ’åºç´¢å¼•ï¼ˆä»å°åˆ°å¤§ï¼‰
order = np.argsort(scores)
print(order)   # [2 4 0 3 1]  â†’ ç¬¬2ä¸ªæœ€å°ï¼Œç¬¬1ä¸ªæœ€å¤§

# æŒ‰ç´¢å¼•å–å€¼ â†’ å¾—åˆ°æ’åºç»“æœ
print(scores[order])       # [0.31 0.56 0.75 0.88 0.92]
print(class_names[order])  # ['bird' 'car' 'cat' 'person' 'dog']

# é™åºï¼šåè½¬ç´¢å¼•
desc_order = np.argsort(scores)[::-1]
print("æŒ‰ç½®ä¿¡åº¦é™åº:")
for i in desc_order:
    print(f"  {class_names[i]}: {scores[i]:.2f}")
# dog: 0.92
# person: 0.88
# cat: 0.75
# car: 0.56
# bird: 0.31
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆ argsort æ¯” sort æ›´å¸¸ç”¨ï¼Ÿ** å› ä¸ºæ’åºåä½ é€šå¸¸è¿˜éœ€è¦çŸ¥é“"æ’åœ¨ç¬¬ä¸€çš„æ˜¯è°"ã€‚argsort ç»™ä½ ç´¢å¼•ï¼Œä½ å¯ä»¥ç”¨è¿™ä¸ªç´¢å¼•å»å–ä»»ä½•ç›¸å…³æ•°æ®ï¼ˆç±»åˆ«åã€åæ ‡ã€å…¶ä»–å±æ€§ç­‰ï¼‰ã€‚

---

### 2. æœç´¢å‡½æ•°

#### 2.1 np.argmax() / np.argmin()

```python
arr = np.array([30, 80, 10, 90, 50])

print(np.argmax(arr))   # 3ï¼ˆç¬¬3ä¸ªå…ƒç´ 90æœ€å¤§ï¼‰
print(np.argmin(arr))   # 2ï¼ˆç¬¬2ä¸ªå…ƒç´ 10æœ€å°ï¼‰

# äºŒç»´æ•°ç»„ï¼šæŒ‰è½´æŸ¥æ‰¾
matrix = np.array([
    [10, 80, 30],
    [90, 20, 70],
    [50, 60, 40]
])

# æ¯è¡Œçš„æœ€å¤§å€¼ä½ç½®
print(np.argmax(matrix, axis=1))   # [1 0 1]ï¼ˆæ¯è¡Œæœ€å¤§å€¼åœ¨ç¬¬å‡ åˆ—ï¼‰

# æ¯åˆ—çš„æœ€å¤§å€¼ä½ç½®
print(np.argmax(matrix, axis=0))   # [1 0 1]ï¼ˆæ¯åˆ—æœ€å¤§å€¼åœ¨ç¬¬å‡ è¡Œï¼‰
```

**å›¾åƒåº”ç”¨ï¼šæ‰¾åˆ°æœ€äº®åƒç´ çš„ä½ç½®**

```python
image = np.random.randint(0, 256, (480, 640), dtype=np.uint8)

# argmax è¿”å›å±•å¹³åçš„ç´¢å¼•ï¼Œç”¨ unravel_index è½¬æˆäºŒç»´åæ ‡
flat_idx = np.argmax(image)
row, col = np.unravel_index(flat_idx, image.shape)
print(f"æœ€äº®åƒç´ : ({row}, {col}), å€¼={image[row, col]}")
```

#### 2.2 np.where()

å‰é¢çš„ç« èŠ‚å·²ç»ä»‹ç»è¿‡ï¼Œè¿™é‡Œè¡¥å……ä¸€äº›é«˜çº§ç”¨æ³•ï¼š

```python
# æ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ä½ç½®
arr = np.array([10, 50, 30, 80, 20, 90])

# è¿”å›æ»¡è¶³æ¡ä»¶çš„ç´¢å¼•
indices = np.where(arr > 50)
print(indices)         # (array([3, 5]),)
print(arr[indices])    # [80 90]

# äºŒç»´æ•°ç»„
matrix = np.array([[1, 5, 3],
                   [7, 2, 8]])
rows, cols = np.where(matrix > 4)
print(f"è¡Œ: {rows}, åˆ—: {cols}")
# è¡Œ: [0 1 1], åˆ—: [1 0 2]  â†’ (0,1)=5, (1,0)=7, (1,2)=8

# æ¡ä»¶æ›¿æ¢
result = np.where(arr > 50, 255, 0)
print(result)   # [  0   0   0 255   0 255]
```

#### 2.3 np.nonzero()

```python
# è¿”å›éé›¶å…ƒç´ çš„ç´¢å¼•
arr = np.array([0, 5, 0, 0, 3, 0, 8])
indices = np.nonzero(arr)
print(indices)       # (array([1, 4, 6]),)
print(arr[indices])  # [5 3 8]

# ç­‰ä»·äº np.where(arr != 0)

# å›¾åƒä¸­æ‰¾éé»‘è‰²åƒç´ 
mask = np.array([[0, 255, 0],
                 [255, 0, 255]], dtype=np.uint8)
rows, cols = np.nonzero(mask)
print(f"éé›¶ä½ç½®: {list(zip(rows, cols))}")
# [(0, 1), (1, 0), (1, 2)]
```

#### 2.4 np.searchsorted()

åœ¨å·²æ’åºçš„æ•°ç»„ä¸­æŸ¥æ‰¾æ’å…¥ä½ç½®â€”â€”åœ¨ç›´æ–¹å›¾è®¡ç®—ã€åˆ†ç®±æ“ä½œä¸­å¾ˆæœ‰ç”¨ï¼š

```python
# å·²æ’åºçš„æ•°ç»„
bins = np.array([0, 50, 100, 150, 200, 255])

# æŸ¥æ‰¾å€¼åº”è¯¥æ’å…¥çš„ä½ç½®
values = np.array([30, 120, 200, 80])
positions = np.searchsorted(bins, values)
print(positions)   # [1 3 4 2]
# 30 åº”è¯¥æ’å…¥åˆ°ç´¢å¼•1ï¼ˆåœ¨0å’Œ50ä¹‹é—´ï¼‰
# 120 åº”è¯¥æ’å…¥åˆ°ç´¢å¼•3ï¼ˆåœ¨100å’Œ150ä¹‹é—´ï¼‰
```

---

### 3. é›†åˆè¿ç®—

#### 3.1 np.unique()ï¼šå»é‡

```python
# åŸºæœ¬å»é‡
labels = np.array(["cat", "dog", "cat", "bird", "dog", "cat"])
unique = np.unique(labels)
print(unique)   # ['bird' 'cat' 'dog']ï¼ˆè‡ªåŠ¨æ’åºï¼‰

# è¿”å›é¢å¤–ä¿¡æ¯
unique, counts = np.unique(labels, return_counts=True)
print(unique)    # ['bird' 'cat' 'dog']
print(counts)    # [1 3 2]ï¼ˆæ¯ä¸ªç±»åˆ«å‡ºç°çš„æ¬¡æ•°ï¼‰

# è¿”å›ç´¢å¼•
unique, indices = np.unique(labels, return_index=True)
print(indices)   # [2 0 1]ï¼ˆæ¯ä¸ªå”¯ä¸€å€¼ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼‰
```

**å›¾åƒåº”ç”¨ï¼šç»Ÿè®¡å”¯ä¸€åƒç´ å€¼**

```python
image = np.random.randint(0, 256, (100, 100), dtype=np.uint8)

# æœ‰å¤šå°‘ç§ä¸åŒçš„åƒç´ å€¼ï¼Ÿ
unique_values = np.unique(image)
print(f"ä¸åŒåƒç´ å€¼çš„æ•°é‡: {len(unique_values)}")  # æ¥è¿‘256

# ç®€æ˜“ç›´æ–¹å›¾
unique_vals, counts = np.unique(image, return_counts=True)
# æ‰¾å‡ºå‡ºç°æœ€å¤šçš„åƒç´ å€¼
most_common_idx = np.argmax(counts)
print(f"æœ€å¸¸è§çš„åƒç´ å€¼: {unique_vals[most_common_idx]}, å‡ºç° {counts[most_common_idx]} æ¬¡")
```

#### 3.2 é›†åˆæ“ä½œ

```python
a = np.array([1, 2, 3, 4, 5])
b = np.array([3, 4, 5, 6, 7])

# äº¤é›†
print(np.intersect1d(a, b))   # [3 4 5]

# å¹¶é›†
print(np.union1d(a, b))       # [1 2 3 4 5 6 7]

# å·®é›†ï¼ˆåœ¨ a ä¸­ä½†ä¸åœ¨ b ä¸­ï¼‰
print(np.setdiff1d(a, b))     # [1 2]

# æˆå‘˜åˆ¤æ–­
print(np.in1d(a, b))          # [False False  True  True  True]
# ç­‰ä»·äº np.isin(a, b)
print(np.isin(a, [2, 4]))     # [False  True False  True False]
```

---

### 4. æ•°ç»„å¤åˆ¶ä¸æ‹¼æ¥å·¥å…·

#### 4.1 np.copy()ï¼šæ·±æ‹·è´

```python
original = np.array([1, 2, 3])

# æµ…æ‹·è´ï¼ˆèµ‹å€¼ï¼‰â†’ å…±äº«å†…å­˜
shallow = original
shallow[0] = 999
print(original)   # [999 2 3]  è¢«æ”¹äº†ï¼

# æ·±æ‹·è´ â†’ ç‹¬ç«‹å‰¯æœ¬
original = np.array([1, 2, 3])
deep = np.copy(original)   # æˆ– original.copy()
deep[0] = 999
print(original)   # [1 2 3]  æ²¡å˜
```

#### 4.2 np.tile()ï¼šå¹³é“ºå¤åˆ¶

```python
# æŠŠå°æ•°ç»„é‡å¤å¹³é“º
pattern = np.array([0, 128, 255])

# æ°´å¹³é‡å¤ 4 æ¬¡
tiled = np.tile(pattern, 4)
print(tiled)   # [  0 128 255   0 128 255   0 128 255   0 128 255]

# äºŒç»´å¹³é“º
small = np.array([[1, 2],
                  [3, 4]])
tiled2d = np.tile(small, (2, 3))   # å‚ç›´2æ¬¡ï¼Œæ°´å¹³3æ¬¡
print(tiled2d)
# [[1 2 1 2 1 2]
#  [3 4 3 4 3 4]
#  [1 2 1 2 1 2]
#  [3 4 3 4 3 4]]
```

**å›¾åƒåº”ç”¨ï¼šåˆ›å»ºæ£‹ç›˜æ ¼å›¾æ¡ˆ**

```python
# åˆ›å»º 8x8 çš„æ£‹ç›˜æ ¼
cell = np.array([[0, 255],
                 [255, 0]], dtype=np.uint8)
checkerboard = np.tile(cell, (4, 4))
print(checkerboard.shape)   # (8, 8)
```

#### 4.3 np.repeat()ï¼šå…ƒç´ é‡å¤

```python
arr = np.array([1, 2, 3])

# æ¯ä¸ªå…ƒç´ é‡å¤ 3 æ¬¡
print(np.repeat(arr, 3))   # [1 1 1 2 2 2 3 3 3]

# äºŒç»´ï¼šæ²¿è½´é‡å¤
matrix = np.array([[1, 2], [3, 4]])
print(np.repeat(matrix, 2, axis=0))   # æ¯è¡Œé‡å¤ 2 æ¬¡
# [[1 2]
#  [1 2]
#  [3 4]
#  [3 4]]
```

> ğŸ’¡ **tile vs repeat çš„åŒºåˆ«ï¼š**
> - `tile`ï¼šæ•´ä½“å¹³é“ºï¼ˆåƒè´´ç“·ç –ï¼‰
> - `repeat`ï¼šé€å…ƒç´ é‡å¤ï¼ˆåƒå¤è¯»æœºï¼‰

---

### 5. æ–‡ä»¶è¯»å†™

NumPy å¯ä»¥æ–¹ä¾¿åœ°å°†æ•°ç»„ä¿å­˜åˆ°æ–‡ä»¶å’Œä»æ–‡ä»¶åŠ è½½ã€‚

#### 5.1 NumPy äºŒè¿›åˆ¶æ ¼å¼ï¼ˆ.npy / .npzï¼‰

```python
# ä¿å­˜å•ä¸ªæ•°ç»„
arr = np.array([1, 2, 3, 4, 5])
np.save("my_array.npy", arr)

# åŠ è½½
loaded = np.load("my_array.npy")
print(loaded)   # [1 2 3 4 5]

# ä¿å­˜å¤šä¸ªæ•°ç»„ï¼ˆå‹ç¼©åŒ…ï¼‰
image = np.random.randint(0, 256, (100, 100), dtype=np.uint8)
labels = np.array([0, 1, 1, 0, 2])
np.savez("dataset.npz", images=image, labels=labels)

# åŠ è½½å¤šä¸ªæ•°ç»„
data = np.load("dataset.npz")
print(data["images"].shape)   # (100, 100)
print(data["labels"])         # [0 1 1 0 2]
print(list(data.keys()))      # ['images', 'labels']

# å‹ç¼©ä¿å­˜ï¼ˆæ–‡ä»¶æ›´å°ï¼‰
np.savez_compressed("dataset_compressed.npz", images=image, labels=labels)
```

#### 5.2 æ–‡æœ¬æ ¼å¼ï¼ˆCSV ç­‰ï¼‰

```python
# ä¿å­˜ä¸ºæ–‡æœ¬æ–‡ä»¶
data = np.array([[1.5, 2.3, 3.1],
                 [4.2, 5.8, 6.0]])

np.savetxt("data.csv", data, delimiter=",", fmt="%.2f",
           header="col1,col2,col3", comments="")

# åŠ è½½æ–‡æœ¬æ–‡ä»¶
loaded = np.loadtxt("data.csv", delimiter=",", skiprows=1)
print(loaded)

# å¤„ç†å¸¦æ ‡é¢˜çš„ CSV
loaded = np.genfromtxt("data.csv", delimiter=",",
                        skip_header=1, dtype=np.float32)
```

> ğŸ’¡ **å»ºè®®ï¼š**
> - å¤§é‡æ•°æ® â†’ ç”¨ `.npy`/`.npz`ï¼ˆå¿«ã€å°ã€ç²¾ç¡®ï¼‰
> - éœ€è¦äººç±»å¯è¯»æˆ–ä¸å…¶ä»–å·¥å…·äº¤æ¢ â†’ ç”¨ `.csv`/`.txt`
> - å¤æ‚æ•°æ®ç»“æ„ â†’ ç”¨ `pandas`ï¼ˆä¸‹ä¸€æ­¥å­¦ä¹ ï¼‰

---

### 6. å®ç”¨å·¥å…·å‡½æ•°

#### 6.1 np.clip()ï¼šå€¼åŸŸè£å‰ª

```python
# å›¾åƒå¤„ç†ä¸­ç”¨å¾—æœ€å¤šçš„å‡½æ•°ä¹‹ä¸€
arr = np.array([-50, 0, 100, 200, 300])
print(np.clip(arr, 0, 255))   # [  0   0 100 200 255]

# å›¾åƒäº®åº¦è°ƒæ•´åè£å‰ª
image = np.random.randint(100, 200, (3, 3), dtype=np.uint8)
bright = np.clip(image.astype(np.int16) + 80, 0, 255).astype(np.uint8)
```

#### 6.2 np.histogram()ï¼šç›´æ–¹å›¾è®¡ç®—

```python
# è®¡ç®—åƒç´ å€¼åˆ†å¸ƒç›´æ–¹å›¾
image = np.random.randint(0, 256, (100, 100), dtype=np.uint8)

# è®¡ç®—ç›´æ–¹å›¾
hist, bin_edges = np.histogram(image, bins=256, range=(0, 256))
print(f"ç›´æ–¹å›¾ shape: {hist.shape}")     # (256,)
print(f"bin è¾¹ç•Œ shape: {bin_edges.shape}")  # (257,)

# æ‰¾åˆ°æœ€äº®çš„åŒºé—´
brightest_bin = np.argmax(hist)
print(f"å‡ºç°æœ€å¤šçš„åƒç´ å€¼: {brightest_bin}, æ¬¡æ•°: {hist[brightest_bin]}")

# ç®€æ˜“å¯è§†åŒ–
print("ç›´æ–¹å›¾é¢„è§ˆï¼ˆæ¯32çº§ä¸€ç»„ï¼‰:")
for i in range(0, 256, 32):
    count = np.sum(hist[i:i+32])
    bar = "â–ˆ" * (count // 20)
    print(f"  [{i:>3d}-{i+31:>3d}]: {count:>5d} {bar}")
```

#### 6.3 np.pad()ï¼šæ•°ç»„å¡«å……

```python
# ç»™æ•°ç»„æ·»åŠ è¾¹æ¡†ï¼ˆå›¾åƒå·ç§¯å‰å¸¸åšçš„æ“ä½œï¼‰
arr = np.array([[1, 2, 3],
                [4, 5, 6]])

# å››å‘¨å¡«å…… 0ï¼Œå„è¾¹å¡«å…… 1 ä¸ªå…ƒç´ 
padded = np.pad(arr, pad_width=1, mode='constant', constant_values=0)
print(padded)
# [[0 0 0 0 0]
#  [0 1 2 3 0]
#  [0 4 5 6 0]
#  [0 0 0 0 0]]

# é•œåƒå¡«å……ï¼ˆè¾¹ç¼˜æ£€æµ‹å¸¸ç”¨ï¼‰
mirror = np.pad(arr, pad_width=1, mode='reflect')
print(mirror)
# [[5 4 5 6 5]
#  [2 1 2 3 2]
#  [5 4 5 6 5]
#  [2 1 2 3 2]]

# å›¾åƒè¾¹æ¡†å¡«å……
image = np.random.randint(0, 256, (100, 150), dtype=np.uint8)
# ä¸Šä¸‹å„å¡«å…… 10 åƒç´ ï¼Œå·¦å³å„å¡«å…… 20 åƒç´ 
bordered = np.pad(image, ((10, 10), (20, 20)), mode='constant', constant_values=0)
print(f"å¡«å……å‰: {image.shape}")     # (100, 150)
print(f"å¡«å……å: {bordered.shape}")  # (120, 190)
```

#### 6.4 np.diff()ï¼šå·®åˆ†

```python
# è®¡ç®—ç›¸é‚»å…ƒç´ çš„å·®å€¼
arr = np.array([10, 30, 20, 50, 40])
print(np.diff(arr))   # [ 20 -10  30 -10]

# å›¾åƒè¾¹ç¼˜æ£€æµ‹çš„ç®€å•åŸç†
row = np.array([100, 100, 100, 200, 200, 200], dtype=np.int16)
edges = np.abs(np.diff(row))
print(edges)   # [  0   0 100   0   0]  â†’ åœ¨100åˆ°200çš„è·³å˜å¤„æ£€æµ‹åˆ°"è¾¹ç¼˜"
```

---

## ğŸ’» ä»£ç å®æˆ˜

### å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒåˆ†æå·¥å…·ç®±

```python
# ===================================================================
# å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒåˆ†æå·¥å…·ç®±
# ç›®æ ‡ï¼šç»¼åˆè¿ç”¨æ’åºã€æœç´¢ã€ç»Ÿè®¡ã€æ–‡ä»¶æ“ä½œ
# ===================================================================

import numpy as np

# ---------- 1. æ£€æµ‹ç»“æœæ’åº ----------
print("=" * 55)
print("ğŸ” ç¬¬ä¸€æ­¥ï¼šæ£€æµ‹ç»“æœæ’åº")
print("=" * 55)

np.random.seed(42)

# æ¨¡æ‹Ÿç›®æ ‡æ£€æµ‹ç»“æœ
n_detections = 8
classes = np.array(["person", "car", "dog", "person", "cat",
                    "car", "bird", "person"])
confidences = np.array([0.92, 0.78, 0.65, 0.88, 0.45,
                        0.71, 0.33, 0.95])

# æŒ‰ç½®ä¿¡åº¦é™åºæ’åº
order = np.argsort(confidences)[::-1]
print("  æŒ‰ç½®ä¿¡åº¦é™åºæ’åˆ—:")
for rank, idx in enumerate(order, 1):
    print(f"    #{rank}: {classes[idx]:>6s}  ç½®ä¿¡åº¦={confidences[idx]:.2f}")

# NMS é£æ ¼çš„ç­›é€‰ï¼šåªä¿ç•™ç½®ä¿¡åº¦ > 0.5 çš„
high_conf_mask = confidences > 0.5
filtered_classes = classes[high_conf_mask]
filtered_scores = confidences[high_conf_mask]
print(f"\n  ç½®ä¿¡åº¦>0.5: {len(filtered_classes)} ä¸ªæ£€æµ‹ç»“æœ")

# ---------- 2. ç±»åˆ«ç»Ÿè®¡ ----------
print("\n" + "=" * 55)
print("ğŸ“Š ç¬¬äºŒæ­¥ï¼šç±»åˆ«ç»Ÿè®¡")
print("=" * 55)

unique_classes, counts = np.unique(classes, return_counts=True)
print("  ç±»åˆ«åˆ†å¸ƒ:")
for cls, cnt in zip(unique_classes, counts):
    bar = "â–ˆ" * (cnt * 5)
    print(f"    {cls:>6s}: {cnt} ä¸ª {bar}")

# ---------- 3. åƒç´ åˆ†æ ----------
print("\n" + "=" * 55)
print("ğŸ–¼ï¸ ç¬¬ä¸‰æ­¥ï¼šåƒç´ å€¼åˆ†æ")
print("=" * 55)

image = np.random.randint(0, 256, (100, 100), dtype=np.uint8)

# ç›´æ–¹å›¾
hist, _ = np.histogram(image, bins=256, range=(0, 256))

# ç»Ÿè®¡ä¿¡æ¯
print(f"  å›¾åƒ shape: {image.shape}")
print(f"  å‡å€¼: {np.mean(image):.1f}")
print(f"  æ ‡å‡†å·®: {np.std(image):.1f}")
print(f"  æœ€æš—: {np.min(image)}, æœ€äº®: {np.max(image)}")

# å”¯ä¸€å€¼ç»Ÿè®¡
unique_vals = np.unique(image)
print(f"  ä¸åŒåƒç´ å€¼: {len(unique_vals)} ç§")

# ç›´æ–¹å›¾é¢„è§ˆ
print("\n  äº®åº¦åˆ†å¸ƒ:")
for i in range(0, 256, 64):
    end = min(i + 64, 256)
    count = np.sum(hist[i:end])
    pct = count / image.size * 100
    bar = "â–ˆ" * int(pct / 2)
    print(f"    [{i:>3d}-{end-1:>3d}]: {pct:>5.1f}% {bar}")

# ---------- 4. æ•°ç»„å·¥å…·å‡½æ•° ----------
print("\n" + "=" * 55)
print("ğŸ”§ ç¬¬å››æ­¥ï¼šå®ç”¨å·¥å…·")
print("=" * 55)

# æ£‹ç›˜æ ¼
cell = np.array([[0, 255], [255, 0]], dtype=np.uint8)
board = np.tile(cell, (3, 3))
print(f"  æ£‹ç›˜æ ¼ shape: {board.shape}")
print(f"  {board}\n")

# å¡«å……
small = np.ones((2, 3), dtype=np.uint8) * 128
padded = np.pad(small, 1, mode='constant', constant_values=0)
print(f"  å¡«å……å‰ {small.shape} â†’ å¡«å……å {padded.shape}")
print(f"  {padded}\n")

# è¾¹ç¼˜æ£€æµ‹ï¼ˆå·®åˆ†ï¼‰
row = np.array([50, 50, 50, 200, 200, 200, 50, 50], dtype=np.int16)
edges = np.abs(np.diff(row))
print(f"  åƒç´ è¡Œ:  {row}")
print(f"  å·®åˆ†è¾¹ç¼˜: {edges}")
print(f"  è¾¹ç¼˜ä½ç½®: {np.where(edges > 50)[0]}")

# ---------- 5. æ•°æ®ä¿å­˜ä¸åŠ è½½ ----------
print("\n" + "=" * 55)
print("ğŸ’¾ ç¬¬äº”æ­¥ï¼šæ•°æ®ä¿å­˜")
print("=" * 55)

# ä¿å­˜æ£€æµ‹ç»“æœ
print("  ä¿å­˜ .npz æ–‡ä»¶...")
# np.savez("detections.npz",
#          classes=classes,
#          confidences=confidences,
#          image=image)
# print("  âœ… å·²ä¿å­˜ detections.npz")

# åŠ è½½
# data = np.load("detections.npz", allow_pickle=True)
# print(f"  åŒ…å«çš„æ•°ç»„: {list(data.keys())}")

print("  ï¼ˆæ–‡ä»¶æ“ä½œç¤ºä¾‹ä»£ç å·²æ³¨é‡Šï¼Œå–æ¶ˆæ³¨é‡Šå³å¯è¿è¡Œï¼‰")
```

**è¿è¡Œè¾“å‡ºç¤ºä¾‹ï¼š**

```
=======================================================
ğŸ” ç¬¬ä¸€æ­¥ï¼šæ£€æµ‹ç»“æœæ’åº
=======================================================
  æŒ‰ç½®ä¿¡åº¦é™åºæ’åˆ—:
    #1: person  ç½®ä¿¡åº¦=0.95
    #2: person  ç½®ä¿¡åº¦=0.92
    #3: person  ç½®ä¿¡åº¦=0.88
    #4:    car  ç½®ä¿¡åº¦=0.78
    #5:    car  ç½®ä¿¡åº¦=0.71
    #6:    dog  ç½®ä¿¡åº¦=0.65
    #7:    cat  ç½®ä¿¡åº¦=0.45
    #8:   bird  ç½®ä¿¡åº¦=0.33

  ç½®ä¿¡åº¦>0.5: 6 ä¸ªæ£€æµ‹ç»“æœ

=======================================================
ğŸ“Š ç¬¬äºŒæ­¥ï¼šç±»åˆ«ç»Ÿè®¡
=======================================================
  ç±»åˆ«åˆ†å¸ƒ:
     bird: 1 ä¸ª â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      car: 2 ä¸ª â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      cat: 1 ä¸ª â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      dog: 1 ä¸ª â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
   person: 3 ä¸ª â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

=======================================================
ğŸ–¼ï¸ ç¬¬ä¸‰æ­¥ï¼šåƒç´ å€¼åˆ†æ
=======================================================
  å›¾åƒ shape: (100, 100)
  å‡å€¼: 127.5
  ä¸åŒåƒç´ å€¼: 256 ç§

  äº®åº¦åˆ†å¸ƒ:
    [  0- 63]: 25.1% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    [ 64-127]: 24.8% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    [128-191]: 25.0% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
    [192-255]: 25.1% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

---

## ğŸš¨ å¸¸è§é—®é¢˜ä¸æ˜“é”™ç‚¹

### Q1: sort() å’Œ argsort() ä»€ä¹ˆæ—¶å€™ç”¨å“ªä¸ªï¼Ÿ

```python
scores = np.array([0.8, 0.3, 0.95, 0.6])

# sort â†’ åªéœ€è¦æ’åºåçš„å€¼
print(np.sort(scores))   # [0.3  0.6  0.8  0.95]

# argsort â†’ éœ€è¦çŸ¥é“"æ’åœ¨ç¬¬ä¸€çš„æ˜¯ç¬¬å‡ ä¸ª"
order = np.argsort(scores)[::-1]
print(f"æœ€é«˜åˆ†æ˜¯ç¬¬ {order[0]} ä¸ª")   # æœ€é«˜åˆ†æ˜¯ç¬¬ 2 ä¸ª

# ç»éªŒæ³•åˆ™ï¼š
# - åªçœ‹æ’åºç»“æœ â†’ sort()
# - éœ€è¦å…³è”å…¶ä»–æ•°æ®ï¼ˆç±»åã€åæ ‡ç­‰ï¼‰â†’ argsort()
```

### Q2: save/load å’Œ savetxt/loadtxt æ€ä¹ˆé€‰ï¼Ÿ

```python
# .npy/.npz â†’ äºŒè¿›åˆ¶ï¼Œå¿«é€Ÿï¼Œç²¾ç¡®ï¼Œé€‚åˆç¨‹åºé—´ä¼ é€’
# .csv/.txt â†’ æ–‡æœ¬ï¼Œäººç±»å¯è¯»ï¼Œé€‚åˆä¸å…¶ä»–å·¥å…·äº¤æ¢

# å¤§é‡å›¾åƒæ•°æ® â†’ np.save / np.savez_compressed
# å°çš„é…ç½®/æ ‡ç­¾ â†’ np.savetxt
# å¤æ‚çš„è¡¨æ ¼æ•°æ® â†’ ç”¨ pandasï¼ˆæ›´æ–¹ä¾¿ï¼‰
```

### Q3: unique è¿”å›çš„æ•°ç»„æ€»æ˜¯æ’åºçš„ï¼Ÿ

```python
# æ˜¯çš„ï¼np.unique è¿”å›çš„ç»“æœæ€»æ˜¯æ’åºçš„
arr = np.array([3, 1, 4, 1, 5, 9, 2, 6])
print(np.unique(arr))   # [1 2 3 4 5 6 9]  æ€»æ˜¯ä»å°åˆ°å¤§

# å¦‚æœæƒ³ä¿æŒåŸå§‹é¡ºåºï¼Œå¯ä»¥ç”¨ return_index
unique_vals, first_idx = np.unique(arr, return_index=True)
original_order = unique_vals[np.argsort(first_idx)]
print(original_order)   # [3 1 4 5 9 2 6]  æŒ‰é¦–æ¬¡å‡ºç°çš„é¡ºåº
```

### Q4: np.pad çš„ä¸åŒæ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```python
arr = np.array([1, 2, 3, 4, 5])

# constantï¼ˆå¸¸æ•°å¡«å……ï¼Œé»˜è®¤0ï¼‰
print(np.pad(arr, 2, mode='constant'))
# [0 0 1 2 3 4 5 0 0]

# edgeï¼ˆè¾¹ç¼˜å€¼å¡«å……ï¼‰
print(np.pad(arr, 2, mode='edge'))
# [1 1 1 2 3 4 5 5 5]

# reflectï¼ˆé•œåƒå¡«å……ï¼Œä¸å«è¾¹ç•Œï¼‰
print(np.pad(arr, 2, mode='reflect'))
# [3 2 1 2 3 4 5 4 3]

# wrapï¼ˆç¯ç»•å¡«å……ï¼‰
print(np.pad(arr, 2, mode='wrap'))
# [4 5 1 2 3 4 5 1 2]

# å›¾åƒå·ç§¯å¸¸ç”¨ reflect æˆ– edge æ¨¡å¼
```

---

## ğŸ¯ æ€»ç»“

æœ¬èŠ‚å­¦ä¹ äº† NumPy çš„å¸¸ç”¨å·¥å…·å‡½æ•°ï¼š

âœ… **æ’åº**ï¼š`sort()`ï¼ˆæ’åºå€¼ï¼‰ã€`argsort()`ï¼ˆæ’åºç´¢å¼•ï¼Œæ›´å¸¸ç”¨ï¼ï¼‰
âœ… **æœç´¢**ï¼š`argmax`/`argmin`ï¼ˆæå€¼ä½ç½®ï¼‰ã€`where`ï¼ˆæ¡ä»¶æœç´¢ï¼‰ã€`nonzero`ï¼ˆéé›¶ä½ç½®ï¼‰
âœ… **é›†åˆ**ï¼š`unique`ï¼ˆå»é‡ç»Ÿè®¡ï¼‰ã€`intersect1d`/`union1d`/`setdiff1d`ï¼ˆé›†åˆè¿ç®—ï¼‰
âœ… **å¤åˆ¶æ‹¼æ¥**ï¼š`copy`ï¼ˆæ·±æ‹·è´ï¼‰ã€`tile`ï¼ˆå¹³é“ºï¼‰ã€`repeat`ï¼ˆé‡å¤ï¼‰
âœ… **æ–‡ä»¶è¯»å†™**ï¼š`save`/`load`ï¼ˆäºŒè¿›åˆ¶ï¼‰ã€`savetxt`/`loadtxt`ï¼ˆæ–‡æœ¬ï¼‰
âœ… **å®ç”¨å·¥å…·**ï¼š`clip`ï¼ˆè£å‰ªï¼‰ã€`histogram`ï¼ˆç›´æ–¹å›¾ï¼‰ã€`pad`ï¼ˆå¡«å……ï¼‰ã€`diff`ï¼ˆå·®åˆ†ï¼‰

> ğŸ”‘ **æ ¸å¿ƒè¦ç‚¹ï¼š** `argsort` æ˜¯æ£€æµ‹ç»“æœæ’åºçš„åˆ©å™¨ï¼Œ`unique` ç”¨äºç±»åˆ«ç»Ÿè®¡ï¼Œ`histogram` ç”¨äºåƒç´ åˆ†å¸ƒåˆ†æï¼Œ`clip` æ˜¯é˜²æº¢å‡ºçš„å¿…å¤‡å‡½æ•°ï¼Œ`pad` æ˜¯å›¾åƒå·ç§¯å‰çš„æ ‡å‡†æ“ä½œã€‚è¿™äº›å‡½æ•°ç»„åˆèµ·æ¥å°±èƒ½å®Œæˆå¤§éƒ¨åˆ†å›¾åƒæ•°æ®åˆ†æä»»åŠ¡ã€‚

**ä¸‹ä¸€æ­¥ï¼š**
ğŸ‘‰ [ç¬¬04ç«  - OpenCVå…¥é—¨](../../ç¬¬04ç« -OpenCVå…¥é—¨/OpenCVå…¥é—¨.md)

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [NumPy å®˜æ–¹æ–‡æ¡£ - æ’åºæœç´¢](https://numpy.org/doc/stable/reference/routines.sort.html)
- [NumPy å®˜æ–¹æ–‡æ¡£ - é›†åˆè¿ç®—](https://numpy.org/doc/stable/reference/routines.set.html)
- [NumPy å®˜æ–¹æ–‡æ¡£ - è¾“å…¥è¾“å‡º](https://numpy.org/doc/stable/reference/routines.io.html)
