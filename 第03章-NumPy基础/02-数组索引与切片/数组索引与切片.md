# æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡

> ç´¢å¼•å’Œåˆ‡ç‰‡æ˜¯è®¿é—®å’Œæ“ä½œæ•°ç»„å…ƒç´ çš„åŸºæœ¬æ‰‹æ®µã€‚åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œè£å‰ªå›¾åƒã€æå–æ„Ÿå…´è¶£åŒºåŸŸï¼ˆROIï¼‰ã€æ“ä½œé¢œè‰²é€šé“â€”â€”è¿™äº›æ“ä½œçš„æœ¬è´¨éƒ½æ˜¯æ•°ç»„çš„ç´¢å¼•ä¸åˆ‡ç‰‡ã€‚

---

## ğŸ“– ç†è®ºéƒ¨åˆ†

### 1. ä¸ºä»€ä¹ˆç´¢å¼•å’Œåˆ‡ç‰‡è¿™ä¹ˆé‡è¦ï¼Ÿ

åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œä½ å‡ ä¹æ¯æ—¶æ¯åˆ»éƒ½åœ¨"è®¿é—®å›¾åƒçš„æŸä¸ªéƒ¨åˆ†"ï¼š

- **è£å‰ªäººè„¸åŒºåŸŸ**ï¼šä»å¤§å›¾ä¸­å–å‡ºäººè„¸æ‰€åœ¨çš„çŸ©å½¢ â†’ äºŒç»´åˆ‡ç‰‡
- **æå–çº¢è‰²é€šé“**ï¼šåªçœ‹å›¾åƒçš„çº¢è‰²ä¿¡æ¯ â†’ ç¬¬ä¸‰ç»´ç´¢å¼•
- **é˜ˆå€¼å¤„ç†**ï¼šæŠŠäº®åº¦ä½äº 50 çš„åƒç´ å˜æˆ 0 â†’ å¸ƒå°”ç´¢å¼•
- **å–å‡ºæ£€æµ‹æ¡†å†…çš„åƒç´ **ï¼šæ ¹æ®åæ ‡åˆ—è¡¨å–å€¼ â†’ èŠ±å¼ç´¢å¼•

è¿™äº›æ“ä½œå…¨éƒ¨ä¾èµ– NumPy çš„ç´¢å¼•å’Œåˆ‡ç‰‡æœºåˆ¶ã€‚

---

### 2. ä¸€ç»´æ•°ç»„ç´¢å¼•ï¼ˆåŸºç¡€å›é¡¾ï¼‰

ä¸€ç»´æ•°ç»„çš„ç´¢å¼•å’Œ Python åˆ—è¡¨å®Œå…¨ä¸€æ ·ï¼š

```python
import numpy as np

arr = np.array([10, 20, 30, 40, 50, 60, 70, 80, 90])
```

#### 2.1 å•ä¸ªå…ƒç´ ç´¢å¼•

```python
# æ­£ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰
print(arr[0])    # 10ï¼ˆç¬¬1ä¸ªå…ƒç´ ï¼‰
print(arr[3])    # 40ï¼ˆç¬¬4ä¸ªå…ƒç´ ï¼‰

# è´Ÿç´¢å¼•ï¼ˆä»æœ«å°¾å€’æ•°ï¼‰
print(arr[-1])   # 90ï¼ˆæœ€åä¸€ä¸ªï¼‰
print(arr[-2])   # 80ï¼ˆå€’æ•°ç¬¬äºŒä¸ªï¼‰
```

```
ç´¢å¼•å›¾è§£ï¼š
å…ƒç´ :     10   20   30   40   50   60   70   80   90
æ­£ç´¢å¼•:    0    1    2    3    4    5    6    7    8
è´Ÿç´¢å¼•:   -9   -8   -7   -6   -5   -4   -3   -2   -1
```

#### 2.2 åˆ‡ç‰‡

```python
# è¯­æ³•: arr[start:stop:step]
# start: èµ·å§‹ç´¢å¼•ï¼ˆå«ï¼‰ï¼Œé»˜è®¤0
# stop:  ç»“æŸç´¢å¼•ï¼ˆä¸å«ï¼‰ï¼Œé»˜è®¤æœ«å°¾
# step:  æ­¥é•¿ï¼Œé»˜è®¤1

print(arr[2:5])     # [30 40 50]   ç´¢å¼•2åˆ°4
print(arr[:3])      # [10 20 30]   å‰3ä¸ª
print(arr[6:])      # [70 80 90]   ä»ç´¢å¼•6åˆ°æœ«å°¾
print(arr[::2])     # [10 30 50 70 90]  æ¯éš”ä¸€ä¸ªå–
print(arr[::-1])    # [90 80 70 60 50 40 30 20 10]  åè½¬
print(arr[1:7:2])   # [20 40 60]   ä»ç´¢å¼•1åˆ°6ï¼Œæ­¥é•¿2
```

```
åˆ‡ç‰‡ arr[2:5] çš„å›¾è§£ï¼š

å…ƒç´ :     10   20  |30   40   50|  60   70   80   90
ç´¢å¼•:      0    1    2    3    4    5    6    7    8
                    â†‘              â†‘
                  start=2        stop=5ï¼ˆä¸å«ï¼‰
                    â””â”€â”€å–è¿™äº›â”€â”€â”˜
```

> âš ï¸ **åˆ‡ç‰‡æ˜¯å·¦é—­å³å¼€çš„ï¼** `arr[2:5]` å–ç´¢å¼• 2ã€3ã€4ï¼Œä¸åŒ…å« 5ã€‚è¿™å’Œ `range()` çš„è¡Œä¸ºä¸€è‡´ã€‚

---

### 3. äºŒç»´æ•°ç»„ç´¢å¼•ï¼ˆå›¾åƒæ“ä½œçš„æ ¸å¿ƒï¼ï¼‰

äºŒç»´æ•°ç»„ç›¸å½“äºç°åº¦å›¾åƒï¼Œæœ‰è¡Œï¼ˆé«˜åº¦ï¼‰å’Œåˆ—ï¼ˆå®½åº¦ï¼‰ä¸¤ä¸ªç»´åº¦ã€‚

```python
# åˆ›å»ºä¸€ä¸ª 4x5 çš„äºŒç»´æ•°ç»„ï¼ˆæ¨¡æ‹Ÿå°ç°åº¦å›¾åƒï¼‰
image = np.array([
    [  0,  50, 100, 150, 200],    # ç¬¬0è¡Œ
    [ 25,  75, 125, 175, 225],    # ç¬¬1è¡Œ
    [ 50, 100, 150, 200, 250],    # ç¬¬2è¡Œ
    [255, 200, 150, 100,  50]     # ç¬¬3è¡Œ
])
print(image.shape)  # (4, 5) â†’ 4è¡Œ5åˆ—
```

#### 3.1 å•ä¸ªå…ƒç´ è®¿é—®

```python
# è¯­æ³•: image[è¡Œ, åˆ—]
print(image[0, 0])    # 0   ï¼ˆå·¦ä¸Šè§’ï¼‰
print(image[0, 4])    # 200 ï¼ˆå³ä¸Šè§’ï¼‰
print(image[3, 0])    # 255 ï¼ˆå·¦ä¸‹è§’ï¼‰
print(image[3, 4])    # 50  ï¼ˆå³ä¸‹è§’ï¼‰
print(image[1, 2])    # 125 ï¼ˆç¬¬1è¡Œç¬¬2åˆ—ï¼‰

# ä¹Ÿå¯ä»¥ç”¨ä¸¤ä¸ªæ–¹æ‹¬å·ï¼ˆä¸æ¨èï¼Œæ•ˆç‡ä½ï¼‰
print(image[1][2])    # 125ï¼ˆæ•ˆæœç›¸åŒï¼Œä½†æ›´æ…¢ï¼‰
```

```
image[1, 2] çš„å®šä½ï¼š

         0åˆ—   1åˆ—   2åˆ—   3åˆ—   4åˆ—
0è¡Œ  [   0,   50,  100,  150,  200 ]
1è¡Œ  [  25,   75, [125], 175,  225 ]  â† ç¬¬1è¡Œ
2è¡Œ  [  50,  100,  150,  200,  250 ]      â†‘
3è¡Œ  [ 255,  200,  150,  100,   50 ]    ç¬¬2åˆ—
```

#### 3.2 è¡Œ/åˆ—åˆ‡ç‰‡ï¼ˆæœ€é‡è¦ï¼å›¾åƒè£å‰ªçš„åŸºç¡€ï¼‰

```python
# å–æŸä¸€è¡Œï¼ˆè¿”å›ä¸€ç»´æ•°ç»„ï¼‰
print(image[0])       # [  0  50 100 150 200]ï¼ˆç¬¬0è¡Œï¼‰
print(image[0, :])    # åŒä¸Šï¼ˆ: è¡¨ç¤ºå–æ‰€æœ‰åˆ—ï¼‰

# å–æŸä¸€åˆ—
print(image[:, 0])    # [  0  25  50 255]ï¼ˆç¬¬0åˆ—ï¼‰
print(image[:, 2])    # [100 125 150 150]ï¼ˆç¬¬2åˆ—ï¼‰

# å–å¤šè¡Œ
print(image[1:3])     # å–ç¬¬1ã€2è¡Œ
# [[ 25  75 125 175 225]
#  [ 50 100 150 200 250]]

# å–å¤šåˆ—
print(image[:, 1:4])  # å–ç¬¬1ã€2ã€3åˆ—
# [[ 50 100 150]
#  [ 75 125 175]
#  [100 150 200]
#  [200 150 100]]
```

#### 3.3 çŸ©å½¢åŒºåŸŸåˆ‡ç‰‡ï¼ˆå›¾åƒè£å‰ªï¼ï¼‰

è¿™æ˜¯å›¾åƒå¤„ç†ä¸­**æœ€æœ€æœ€å¸¸ç”¨**çš„æ“ä½œï¼š

```python
# è¯­æ³•: image[è¡Œèµ·:è¡Œæ­¢, åˆ—èµ·:åˆ—æ­¢]
# å³:   image[y1:y2, x1:x2]

# å–å·¦ä¸Šè§’ 2x3 çš„åŒºåŸŸ
roi = image[0:2, 0:3]
print(roi)
# [[  0  50 100]
#  [ 25  75 125]]

# å–ä¸­é—´åŒºåŸŸ
center = image[1:3, 1:4]
print(center)
# [[ 75 125 175]
#  [100 150 200]]
```

```
image[1:3, 1:4] çš„å›¾è§£ï¼š

         0åˆ—   1åˆ—   2åˆ—   3åˆ—   4åˆ—
0è¡Œ  [   0,   50,  100,  150,  200 ]
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
1è¡Œ  [  25, | 75,  125,  175|, 225 ]
2è¡Œ  [  50, |100,  150,  200|, 250 ]
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3è¡Œ  [ 255,  200,  150,  100,   50 ]

è¡Œ: 1:3ï¼ˆç¬¬1ã€2è¡Œï¼‰
åˆ—: 1:4ï¼ˆç¬¬1ã€2ã€3åˆ—ï¼‰
```

**å®é™…å›¾åƒè£å‰ªç¤ºä¾‹ï¼š**

```python
# å‡è®¾æˆ‘ä»¬æœ‰ä¸€å¼  1080x1920 çš„å›¾åƒ
# æ£€æµ‹åˆ°äººè„¸åœ¨ä½ç½® (x=500, y=200, w=300, h=400)
# è£å‰ªäººè„¸åŒºåŸŸï¼š

# face = image[y:y+h, x:x+w]
# face = image[200:600, 500:800]

# æ³¨æ„ï¼shape æ˜¯ (é«˜, å®½)ï¼Œä½†åæ ‡æ˜¯ (x, y)
# è£å‰ªæ—¶ï¼šimage[yæ–¹å‘, xæ–¹å‘]
```

> âš ï¸ **å…³é”®æé†’ï¼š** å›¾åƒçš„ shape æ˜¯ `(é«˜åº¦, å®½åº¦)` = `(è¡Œæ•°, åˆ—æ•°)`ã€‚
> è£å‰ªæ—¶å†™ `image[y1:y2, x1:x2]`ï¼Œ**yï¼ˆè¡Œï¼‰åœ¨å‰ï¼Œxï¼ˆåˆ—ï¼‰åœ¨å**ã€‚
> è¿™å’Œæ—¥å¸¸çš„ (x, y) åæ ‡æ˜¯åè¿‡æ¥çš„ï¼æ–°æ‰‹åŠ¡å¿…æ³¨æ„ã€‚

---

### 4. ä¸‰ç»´æ•°ç»„ç´¢å¼•ï¼ˆå½©è‰²å›¾åƒæ“ä½œï¼‰

å½©è‰²å›¾åƒæ˜¯ä¸‰ç»´æ•°ç»„ `(é«˜åº¦, å®½åº¦, é€šé“)`ï¼Œç¬¬ä¸‰ä¸ªç»´åº¦æ˜¯é¢œè‰²é€šé“ã€‚

```python
# åˆ›å»ºä¸€ä¸ª 3x4 çš„å½©è‰²å›¾åƒï¼ˆæ¨¡æ‹Ÿï¼‰
color_image = np.zeros((3, 4, 3), dtype=np.uint8)

# è®¾ç½®ä¸€äº›é¢œè‰²
color_image[0, 0] = [255, 0, 0]     # ç¬¬(0,0)åƒç´  = è“è‰²ï¼ˆBGRï¼‰
color_image[0, 1] = [0, 255, 0]     # ç¬¬(0,1)åƒç´  = ç»¿è‰²
color_image[0, 2] = [0, 0, 255]     # ç¬¬(0,2)åƒç´  = çº¢è‰²
color_image[0, 3] = [255, 255, 255] # ç¬¬(0,3)åƒç´  = ç™½è‰²
```

#### 4.1 è®¿é—®å•ä¸ªåƒç´ 

```python
# è·å–åƒç´ å€¼ï¼ˆè¿”å› [B, G, R] æ•°ç»„ï¼‰
pixel = color_image[0, 0]
print(pixel)        # [255   0   0]ï¼ˆè“è‰²ï¼‰
print(pixel[0])     # 255ï¼ˆBé€šé“å€¼ï¼‰
print(pixel[1])     # 0ï¼ˆGé€šé“å€¼ï¼‰
print(pixel[2])     # 0ï¼ˆRé€šé“å€¼ï¼‰

# ç›´æ¥è·å–æŸä¸ªé€šé“çš„å€¼
blue_val = color_image[0, 0, 0]    # B é€šé“
green_val = color_image[0, 0, 1]   # G é€šé“
red_val = color_image[0, 0, 2]     # R é€šé“
```

#### 4.2 æå–é¢œè‰²é€šé“ï¼ˆé€šé“åˆ†ç¦»ï¼‰

```python
# æå–æ•´ä¸ªé€šé“ï¼ˆéå¸¸å¸¸ç”¨ï¼ï¼‰
b_channel = color_image[:, :, 0]   # è“è‰²é€šé“ï¼ˆäºŒç»´æ•°ç»„ï¼‰
g_channel = color_image[:, :, 1]   # ç»¿è‰²é€šé“
r_channel = color_image[:, :, 2]   # çº¢è‰²é€šé“

print(b_channel.shape)  # (3, 4)  â€” æ¯ä¸ªé€šé“æ˜¯äºŒç»´çš„
```

```
é€šé“åˆ†ç¦»å›¾è§£ï¼š

å½©è‰²å›¾åƒ (3, 4, 3)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [B,G,R] [B,G,R]  â”‚
â”‚ [B,G,R] [B,G,R]  â”‚  â†’ æ‹†æˆ 3 ä¸ª (3, 4) çš„ç°åº¦å›¾
â”‚ [B,G,R] [B,G,R]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Bé€šé“          Gé€šé“          Ré€šé“
  [:,:,0]        [:,:,1]        [:,:,2]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ B B B B â”‚  â”‚ G G G G â”‚  â”‚ R R R R â”‚
â”‚ B B B B â”‚  â”‚ G G G G â”‚  â”‚ R R R R â”‚
â”‚ B B B B â”‚  â”‚ G G G G â”‚  â”‚ R R R R â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.3 ä¿®æ”¹é¢œè‰²é€šé“

```python
# å°†çº¢è‰²é€šé“è®¾ä¸º 0ï¼ˆå»æ‰çº¢è‰²ï¼‰
no_red = color_image.copy()    # å…ˆå¤åˆ¶ï¼Œä¸ä¿®æ”¹åŸå›¾
no_red[:, :, 2] = 0            # Ré€šé“å…¨è®¾ä¸º0

# åªä¿ç•™ç»¿è‰²é€šé“
green_only = np.zeros_like(color_image)
green_only[:, :, 1] = color_image[:, :, 1]   # åªå¤åˆ¶Gé€šé“

# äº¤æ¢çº¢è“é€šé“ï¼ˆBGR â†’ RGBï¼‰
rgb_image = color_image[:, :, ::-1]   # é€šé“ç»´åº¦åè½¬ï¼
# ç­‰ä»·äºï¼š
rgb_image = color_image[:, :, [2, 1, 0]]   # èŠ±å¼ç´¢å¼•æ–¹å¼
```

> ğŸ’¡ **BGR vs RGBï¼š** OpenCV è¯»å–çš„å›¾åƒæ˜¯ BGR é¡ºåºï¼Œä½† Matplotlib æ˜¾ç¤ºæ—¶éœ€è¦ RGB é¡ºåºã€‚é€šé“åè½¬ `[:,:,::-1]` æ˜¯æœ€ç®€æ´çš„è½¬æ¢æ–¹å¼ã€‚

---

### 5. å¸ƒå°”ç´¢å¼•ï¼ˆæ¡ä»¶ç­›é€‰ï¼‰

å¸ƒå°”ç´¢å¼•æ˜¯ NumPy æœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€â€”â€”ç”¨æ¡ä»¶è¡¨è¾¾å¼æ¥ç­›é€‰å’Œä¿®æ”¹æ•°ç»„å…ƒç´ ã€‚

#### 5.1 åŸºæœ¬ç”¨æ³•

```python
arr = np.array([10, 25, 50, 75, 100, 150, 200, 255])

# æ¡ä»¶æ¯”è¾ƒ â†’ å¾—åˆ°å¸ƒå°”æ•°ç»„
mask = arr > 100
print(mask)
# [False False False False False  True  True  True]

# ç”¨å¸ƒå°”æ•°ç»„ä½œä¸ºç´¢å¼• â†’ ç­›é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„å…ƒç´ 
result = arr[mask]
print(result)   # [150 200 255]

# é€šå¸¸ä¸€æ­¥å†™å®Œï¼š
bright_pixels = arr[arr > 100]
print(bright_pixels)   # [150 200 255]
```

#### 5.2 å›¾åƒé˜ˆå€¼å¤„ç†ï¼ˆç»å…¸åº”ç”¨ï¼ï¼‰

```python
# æ¨¡æ‹Ÿä¸€å¼ ç°åº¦å›¾åƒ
image = np.array([
    [  0,  50, 100, 150],
    [200, 250, 180,  30],
    [ 80, 120, 160, 220]
], dtype=np.uint8)

# äºŒå€¼åŒ–ï¼šåƒç´ å€¼ > 128 çš„è®¾ä¸º 255ï¼Œå¦åˆ™è®¾ä¸º 0
binary = np.zeros_like(image)
binary[image > 128] = 255
print(binary)
# [[  0   0   0 255]
#  [255 255 255   0]
#  [  0   0 255 255]]

# æ›´ç®€æ´çš„å†™æ³•ï¼ˆåˆ©ç”¨å¸ƒå°”å€¼ä¹˜æ³•ï¼‰
binary2 = (image > 128).astype(np.uint8) * 255
print(binary2)  # ç»“æœç›¸åŒ
```

#### 5.3 å¤šæ¡ä»¶ç»„åˆ

```python
# âš ï¸ æ³¨æ„ï¼šNumPy ä¸­ç”¨ & (ä¸)ã€| (æˆ–)ã€~ (é)ï¼Œä¸æ˜¯ and/or/notï¼
# è€Œä¸”æ¯ä¸ªæ¡ä»¶å¿…é¡»åŠ æ‹¬å·ï¼

# é€‰å‡º 50 åˆ° 200 ä¹‹é—´çš„åƒç´ 
mask = (image >= 50) & (image <= 200)
selected = image[mask]
print(selected)   # [50 100 150 200 180 80 120 160]

# é€‰å‡ºéå¸¸äº®æˆ–éå¸¸æš—çš„åƒç´ 
extreme = image[(image < 30) | (image > 220)]
print(extreme)    # [  0 250 220 30]  ... æ³¨æ„30ä¸æ»¡è¶³<30

# å–åï¼šé€‰å‡ºä¸åœ¨ 50~200 èŒƒå›´å†…çš„åƒç´ 
outside = image[~mask]
print(outside)    # [0 250 30 220]
```

> âš ï¸ **å¸¸è§é”™è¯¯ï¼š** NumPy æ•°ç»„çš„æ¡ä»¶ç»„åˆ**ä¸èƒ½ç”¨ `and`/`or`**ï¼
> ```python
> # âŒ é”™è¯¯ï¼ä¼šæŠ¥ ValueError
> # result = image[(image > 50) and (image < 200)]
>
> # âœ… æ­£ç¡®ï¼ç”¨ & å’Œ |ï¼Œå¹¶åŠ æ‹¬å·
> result = image[(image > 50) & (image < 200)]
> ```

#### 5.4 æ¡ä»¶èµ‹å€¼ï¼ˆå›¾åƒä¿®æ”¹ï¼‰

```python
# æŠŠæš—åƒç´ æäº®
image_copy = image.copy()
image_copy[image_copy < 50] = 50     # æœ€ä½äº®åº¦è®¾ä¸º50
print(image_copy)
# [[ 50  50 100 150]
#  [200 250 180  50]
#  [ 80 120 160 220]]

# è£å‰ªåƒç´ èŒƒå›´ï¼ˆç­‰ä»·äº np.clipï¼‰
result = image.copy()
result[result < 50] = 50
result[result > 200] = 200
# ç­‰ä»·äºï¼š
result2 = np.clip(image, 50, 200)
```

---

### 6. èŠ±å¼ç´¢å¼•ï¼ˆé«˜çº§ç”¨æ³•ï¼‰

èŠ±å¼ç´¢å¼•ï¼ˆFancy Indexingï¼‰ç”¨æ•´æ•°æ•°ç»„ä½œä¸ºç´¢å¼•ï¼Œå¯ä»¥æŒ‰ä»»æ„é¡ºåºè®¿é—®å…ƒç´ ã€‚

#### 6.1 ä¸€ç»´èŠ±å¼ç´¢å¼•

```python
arr = np.array([10, 20, 30, 40, 50, 60, 70])

# ç”¨ç´¢å¼•æ•°ç»„é€‰å–ç‰¹å®šä½ç½®çš„å…ƒç´ 
indices = np.array([0, 2, 5])
print(arr[indices])    # [10 30 60]

# ä¹Ÿå¯ä»¥ç”¨åˆ—è¡¨
print(arr[[0, 2, 5]])  # [10 30 60]

# å¯ä»¥é‡å¤ç´¢å¼•
print(arr[[0, 0, 1, 1]])  # [10 10 20 20]

# å¯ä»¥ä¹±åº
print(arr[[6, 4, 2, 0]])  # [70 50 30 10]
```

#### 6.2 äºŒç»´èŠ±å¼ç´¢å¼•

```python
image = np.array([
    [  0,  50, 100],
    [150, 200, 250],
    [255, 200, 150]
])

# å–ç‰¹å®šè¡Œ
rows = image[[0, 2]]    # å–ç¬¬0è¡Œå’Œç¬¬2è¡Œ
print(rows)
# [[  0  50 100]
#  [255 200 150]]

# å–ç‰¹å®šä½ç½®çš„å…ƒç´ 
# image[è¡Œç´¢å¼•æ•°ç»„, åˆ—ç´¢å¼•æ•°ç»„]
row_idx = np.array([0, 1, 2])
col_idx = np.array([0, 1, 2])
diagonal = image[row_idx, col_idx]   # å–å¯¹è§’çº¿å…ƒç´ 
print(diagonal)   # [  0 200 150]

# å–ä»»æ„ä½ç½®çš„åƒç´ ï¼ˆæ¯”å¦‚æ£€æµ‹æ¡†çš„è§’ç‚¹ï¼‰
corners = image[[0, 0, 2, 2], [0, 2, 0, 2]]
print(corners)    # [  0 100 255 150]ï¼ˆå››ä¸ªè§’çš„å€¼ï¼‰
```

#### 6.3 np.where()ï¼šæ¡ä»¶ç´¢å¼•çš„åˆ©å™¨

`np.where()` å¯ä»¥æ ¹æ®æ¡ä»¶è¿”å›ç´¢å¼•ä½ç½®æˆ–è¿›è¡Œæ¡ä»¶èµ‹å€¼ï¼š

```python
arr = np.array([10, 50, 100, 150, 200])

# ç”¨æ³•1ï¼šè¿”å›æ»¡è¶³æ¡ä»¶çš„ç´¢å¼•ä½ç½®
indices = np.where(arr > 100)
print(indices)        # (array([3, 4]),)  ç¬¬3å’Œç¬¬4ä¸ªä½ç½®
print(arr[indices])   # [150 200]

# ç”¨æ³•2ï¼šæ¡ä»¶èµ‹å€¼ï¼ˆä¸‰å‚æ•°å½¢å¼ï¼‰
# np.where(æ¡ä»¶, æ¡ä»¶ä¸ºTrueæ—¶çš„å€¼, æ¡ä»¶ä¸ºFalseæ—¶çš„å€¼)
result = np.where(arr > 100, 255, 0)
print(result)   # [  0   0   0 255 255]

# å›¾åƒäºŒå€¼åŒ–çš„æœ€ç®€æ´å†™æ³•ï¼
image = np.random.randint(0, 256, (4, 5), dtype=np.uint8)
binary = np.where(image > 128, 255, 0).astype(np.uint8)
print(binary)
```

> ğŸ’¡ **np.where çš„ä¸¤ç§ç”¨æ³•ï¼š**
> - **1ä¸ªå‚æ•°**ï¼š`np.where(æ¡ä»¶)` â†’ è¿”å›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ **ç´¢å¼•**
> - **3ä¸ªå‚æ•°**ï¼š`np.where(æ¡ä»¶, A, B)` â†’ æ¡ä»¶ä¸ºçœŸå–Aï¼Œä¸ºå‡å–B

---

### 7. åˆ‡ç‰‡çš„é‡è¦ç‰¹æ€§ï¼šè§†å›¾ vs å‰¯æœ¬

è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦ä½†å®¹æ˜“å¿½ç•¥çš„æ¦‚å¿µï¼š

#### 7.1 åˆ‡ç‰‡è¿”å›è§†å›¾ï¼ˆå…±äº«å†…å­˜ï¼‰

```python
original = np.array([10, 20, 30, 40, 50])

# åˆ‡ç‰‡å¾—åˆ°çš„æ˜¯"è§†å›¾"ï¼ˆviewï¼‰ï¼Œå’ŒåŸæ•°ç»„å…±äº«å†…å­˜
view = original[1:4]
print(view)   # [20 30 40]

# ä¿®æ”¹è§†å›¾ä¼šå½±å“åŸæ•°ç»„ï¼
view[0] = 999
print(original)   # [ 10 999  30  40  50]   åŸæ•°ç»„ä¹Ÿè¢«æ”¹äº†ï¼
```

```
å†…å­˜å…±äº«å›¾è§£ï¼š

original: [10] [20] [30] [40] [50]
                â†‘    â†‘    â†‘
view:          [20] [30] [40]

view å’Œ original æŒ‡å‘åŒä¸€å—å†…å­˜ï¼Œä¿®æ”¹ä¸€ä¸ªå¦ä¸€ä¸ªä¹Ÿä¼šå˜ï¼
```

#### 7.2 å¦‚ä½•åˆ›å»ºç‹¬ç«‹å‰¯æœ¬

```python
original = np.array([10, 20, 30, 40, 50])

# ä½¿ç”¨ .copy() åˆ›å»ºç‹¬ç«‹å‰¯æœ¬
copy = original[1:4].copy()
copy[0] = 999
print(original)   # [10 20 30 40 50]   åŸæ•°ç»„ä¸å—å½±å“ï¼
```

**ä»€ä¹ˆæ—¶å€™éœ€è¦ copyï¼Ÿ**

```python
# åœºæ™¯ï¼šè£å‰ªå›¾åƒçš„ ROI åè¦ä¿®æ”¹å®ƒ
image = np.random.randint(0, 256, (480, 640), dtype=np.uint8)

# âŒ è¿™æ ·ä¿®æ”¹ ROI ä¼šå½±å“åŸå›¾ï¼
roi = image[100:200, 200:400]
roi[:] = 0   # åŸå›¾çš„è¿™ä¸ªåŒºåŸŸä¹Ÿå˜æˆ0äº†

# âœ… æƒ³è¦ç‹¬ç«‹çš„è£å‰ªç»“æœï¼Œç”¨ copy
roi = image[100:200, 200:400].copy()
roi[:] = 0   # åŸå›¾ä¸å—å½±å“
```

> ğŸ’¡ **è®°å¿†æŠ€å·§ï¼š**
> - **åˆ‡ç‰‡** â†’ è§†å›¾ï¼ˆå…±äº«å†…å­˜ï¼Œå¿«ï¼Œä½†ä¿®æ”¹ä¼šäº’ç›¸å½±å“ï¼‰
> - **èŠ±å¼ç´¢å¼•** â†’ å‰¯æœ¬ï¼ˆç‹¬ç«‹å†…å­˜ï¼Œä¿®æ”¹ä¸äº’ç›¸å½±å“ï¼‰
> - **å¸ƒå°”ç´¢å¼•** â†’ å‰¯æœ¬ï¼ˆç‹¬ç«‹å†…å­˜ï¼‰
> - æƒ³è¦ç‹¬ç«‹å‰¯æœ¬ â†’ åŠ  `.copy()`

---

## ğŸ’» ä»£ç å®æˆ˜

### å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒ ROI å¤„ç†å™¨

```python
# ===================================================================
# å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒ ROI å¤„ç†å™¨
# ç›®æ ‡ï¼šç»¼åˆè¿ç”¨ç´¢å¼•ã€åˆ‡ç‰‡ã€å¸ƒå°”ç´¢å¼•
# ===================================================================

import numpy as np

# ---------- 1. åˆ›å»ºæµ‹è¯•å›¾åƒ ----------
print("=" * 55)
print("ğŸ–¼ï¸ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¨¡æ‹Ÿå›¾åƒ")
print("=" * 55)

np.random.seed(42)

# ç°åº¦å›¾åƒ 8x10
gray = np.random.randint(0, 256, (8, 10), dtype=np.uint8)
print(f"  ç°åº¦å›¾ shape: {gray.shape}")
print(f"  å†…å®¹:\n{gray}\n")

# ---------- 2. åŸºæœ¬ç´¢å¼•æ“ä½œ ----------
print("=" * 55)
print("ğŸ“ ç¬¬äºŒæ­¥ï¼šåŸºæœ¬ç´¢å¼•")
print("=" * 55)

print(f"  å·¦ä¸Šè§’åƒç´  [0,0]:  {gray[0, 0]}")
print(f"  å³ä¸Šè§’åƒç´  [0,-1]: {gray[0, -1]}")
print(f"  å·¦ä¸‹è§’åƒç´  [-1,0]: {gray[-1, 0]}")
print(f"  å³ä¸‹è§’åƒç´  [-1,-1]: {gray[-1, -1]}")
print(f"  ä¸­å¿ƒåƒç´  [4,5]:    {gray[4, 5]}")

# ---------- 3. åˆ‡ç‰‡è£å‰ª ----------
print("\n" + "=" * 55)
print("âœ‚ï¸ ç¬¬ä¸‰æ­¥ï¼šå›¾åƒè£å‰ªï¼ˆåˆ‡ç‰‡ï¼‰")
print("=" * 55)

# è£å‰ªå·¦ä¸Šè§’ 4x5 åŒºåŸŸ
top_left = gray[0:4, 0:5]
print(f"  å·¦ä¸Šè§’ 4x5:\n{top_left}\n")

# è£å‰ªå³ä¸‹è§’ 3x4 åŒºåŸŸ
bottom_right = gray[-3:, -4:]
print(f"  å³ä¸‹è§’ 3x4:\n{bottom_right}\n")

# æ¯éš”ä¸€è¡Œä¸€åˆ—å–æ ·ï¼ˆé™é‡‡æ ·ï¼‰
downsampled = gray[::2, ::2]
print(f"  2å€é™é‡‡æ · {gray.shape} â†’ {downsampled.shape}:\n{downsampled}\n")

# ç¿»è½¬å›¾åƒ
flipped_h = gray[:, ::-1]    # æ°´å¹³ç¿»è½¬
flipped_v = gray[::-1, :]    # å‚ç›´ç¿»è½¬
print(f"  æ°´å¹³ç¿»è½¬ç¬¬ä¸€è¡Œ: {flipped_h[0]}")
print(f"  åŸå›¾ç¬¬ä¸€è¡Œ:     {gray[0]}")

# ---------- 4. å¸ƒå°”ç´¢å¼•æ“ä½œ ----------
print("\n" + "=" * 55)
print("ğŸ¯ ç¬¬å››æ­¥ï¼šå¸ƒå°”ç´¢å¼•ï¼ˆé˜ˆå€¼å¤„ç†ï¼‰")
print("=" * 55)

# ç»Ÿè®¡åƒç´ åˆ†å¸ƒ
print(f"  > 200 çš„åƒç´ æ•°: {np.sum(gray > 200)}")
print(f"  < 50 çš„åƒç´ æ•°:  {np.sum(gray < 50)}")
print(f"  50~200 çš„åƒç´ æ•°: {np.sum((gray >= 50) & (gray <= 200))}")

# äºŒå€¼åŒ–
threshold = 128
binary = np.where(gray > threshold, 255, 0).astype(np.uint8)
print(f"\n  é˜ˆå€¼={threshold} äºŒå€¼åŒ–ç»“æœ:\n{binary}\n")

# äº®åº¦è£å‰ª
clipped = gray.copy()
clipped[clipped < 50] = 50
clipped[clipped > 200] = 200
print(f"  è£å‰ªåˆ° [50, 200]:\n{clipped}")

# ---------- 5. å½©è‰²å›¾åƒé€šé“æ“ä½œ ----------
print("\n" + "=" * 55)
print("ğŸŒˆ ç¬¬äº”æ­¥ï¼šå½©è‰²å›¾åƒé€šé“æ“ä½œ")
print("=" * 55)

# åˆ›å»ºä¸€ä¸ªå°çš„å½©è‰²å›¾åƒ
color = np.zeros((4, 4, 3), dtype=np.uint8)
color[0:2, 0:2] = [255, 0, 0]     # å·¦ä¸Šï¼šè“è‰²
color[0:2, 2:4] = [0, 255, 0]     # å³ä¸Šï¼šç»¿è‰²
color[2:4, 0:2] = [0, 0, 255]     # å·¦ä¸‹ï¼šçº¢è‰²
color[2:4, 2:4] = [255, 255, 255] # å³ä¸‹ï¼šç™½è‰²

print(f"  å½©è‰²å›¾ shape: {color.shape}")
print(f"  å·¦ä¸Šè§’åƒç´  (BGR): {color[0, 0]}")
print(f"  å³ä¸‹è§’åƒç´  (BGR): {color[3, 3]}")

# åˆ†ç¦»é€šé“
b = color[:, :, 0]
g = color[:, :, 1]
r = color[:, :, 2]
print(f"\n  Bé€šé“:\n{b}")
print(f"\n  Gé€šé“:\n{g}")
print(f"\n  Ré€šé“:\n{r}")

# BGR â†’ RGBï¼ˆMatplotlib æ˜¾ç¤ºéœ€è¦ï¼‰
rgb = color[:, :, ::-1]
print(f"\n  BGRâ†’RGB åå·¦ä¸Šè§’: {rgb[0, 0]}")  # [0 0 255]ï¼ˆRGBçš„è“è‰²ï¼‰

# ---------- 6. np.where é«˜çº§åº”ç”¨ ----------
print("\n" + "=" * 55)
print("ğŸ” ç¬¬å…­æ­¥ï¼šnp.where æ¡ä»¶æ“ä½œ")
print("=" * 55)

# æ‰¾å‡ºäº®ç‚¹çš„ä½ç½®
bright_mask = gray > 200
positions = np.where(bright_mask)
print(f"  äº®åº¦>200 çš„åƒç´ ä½ç½®:")
print(f"    è¡Œç´¢å¼•: {positions[0]}")
print(f"    åˆ—ç´¢å¼•: {positions[1]}")

# ç”¨ zip æ˜¾ç¤ºåæ ‡
coords = list(zip(positions[0], positions[1]))
print(f"    åæ ‡åˆ—è¡¨ (è¡Œ,åˆ—): {coords[:5]}...")

# ç»Ÿè®¡æ¯è¡Œçš„äº®åƒç´ æ•°
for row in range(gray.shape[0]):
    bright_count = np.sum(gray[row] > 128)
    bar = "â–ˆ" * bright_count + "â–‘" * (gray.shape[1] - bright_count)
    print(f"    ç¬¬{row}è¡Œ: {bright_count}/{gray.shape[1]} [{bar}]")
```

**è¿è¡Œè¾“å‡ºç¤ºä¾‹ï¼š**

```
=======================================================
ğŸ–¼ï¸ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¨¡æ‹Ÿå›¾åƒ
=======================================================
  ç°åº¦å›¾ shape: (8, 10)
  å†…å®¹:
[[102 179  92  14 106 ... ]]

=======================================================
ğŸ“ ç¬¬äºŒæ­¥ï¼šåŸºæœ¬ç´¢å¼•
=======================================================
  å·¦ä¸Šè§’åƒç´  [0,0]:  102
  å³ä¸Šè§’åƒç´  [0,-1]: 156
  å·¦ä¸‹è§’åƒç´  [-1,0]: 83
  å³ä¸‹è§’åƒç´  [-1,-1]: 42

=======================================================
âœ‚ï¸ ç¬¬ä¸‰æ­¥ï¼šå›¾åƒè£å‰ªï¼ˆåˆ‡ç‰‡ï¼‰
=======================================================
  å·¦ä¸Šè§’ 4x5:
  ...

  2å€é™é‡‡æ · (8, 10) â†’ (4, 5):
  ...

=======================================================
ğŸ¯ ç¬¬å››æ­¥ï¼šå¸ƒå°”ç´¢å¼•ï¼ˆé˜ˆå€¼å¤„ç†ï¼‰
=======================================================
  > 200 çš„åƒç´ æ•°: 15
  < 50 çš„åƒç´ æ•°:  12
  50~200 çš„åƒç´ æ•°: 53

=======================================================
ğŸŒˆ ç¬¬äº”æ­¥ï¼šå½©è‰²å›¾åƒé€šé“æ“ä½œ
=======================================================
  å½©è‰²å›¾ shape: (4, 4, 3)
  å·¦ä¸Šè§’åƒç´  (BGR): [255   0   0]
  BGRâ†’RGB åå·¦ä¸Šè§’: [  0   0 255]
```

---

## ğŸš¨ å¸¸è§é—®é¢˜ä¸æ˜“é”™ç‚¹

### Q1: å›¾åƒè£å‰ªæ—¶è¡Œåˆ—é¡ºåºæ€»æåï¼Ÿ

```python
# æ£€æµ‹æ¡†é€šå¸¸ç»™çš„æ˜¯ (x, y, w, h) åæ ‡
x, y, w, h = 100, 50, 200, 150

# è£å‰ªæ—¶ï¼šimage[yæ–¹å‘, xæ–¹å‘]
# roi = image[y:y+h, x:x+w]

# åŠ©è®°ï¼šshape æ˜¯ (height, width)
#        ç´¢å¼•æ˜¯ [è¡Œ(y),  åˆ—(x)]
#        è£å‰ªæ˜¯ [y:y+h,  x:x+w]
```

### Q2: ä¿®æ”¹åˆ‡ç‰‡ç»“æœä¼šå½±å“åŸæ•°ç»„ï¼Ÿ

```python
# åˆ‡ç‰‡æ˜¯è§†å›¾ï¼Œå…±äº«å†…å­˜
arr = np.arange(10)
view = arr[2:5]
view[0] = 999
print(arr)   # [ 0  1 999  3  4  5  6  7  8  9] â† è¢«æ”¹äº†ï¼

# è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ .copy()
arr = np.arange(10)
safe = arr[2:5].copy()
safe[0] = 999
print(arr)   # [0 1 2 3 4 5 6 7 8 9] â† æ²¡å˜
```

### Q3: å¸ƒå°”ç´¢å¼•çš„ & å’Œ | å¿…é¡»åŠ æ‹¬å·ï¼Ÿ

```python
arr = np.array([10, 50, 100, 150, 200])

# âŒ ä¸åŠ æ‹¬å·ä¼šæŠ¥é”™ï¼ˆè¿ç®—ç¬¦ä¼˜å…ˆçº§é—®é¢˜ï¼‰
# result = arr[arr > 50 & arr < 200]   # é”™è¯¯ï¼

# âœ… å¿…é¡»åŠ æ‹¬å·
result = arr[(arr > 50) & (arr < 200)]
print(result)   # [100 150]
```

### Q4: å¦‚ä½•åˆ¤æ–­ç°åº¦å›¾å’Œå½©è‰²å›¾ï¼Ÿ

```python
def get_image_type(image):
    """åˆ¤æ–­å›¾åƒç±»å‹"""
    if image.ndim == 2:
        return "ç°åº¦å›¾"
    elif image.ndim == 3:
        channels = image.shape[2]
        if channels == 3:
            return "å½©è‰²å›¾ (3é€šé“)"
        elif channels == 4:
            return "å¸¦é€æ˜é€šé“ (4é€šé“)"
    return "æœªçŸ¥ç±»å‹"

# ä½¿ç”¨
gray = np.zeros((100, 100), dtype=np.uint8)
color = np.zeros((100, 100, 3), dtype=np.uint8)
print(get_image_type(gray))    # ç°åº¦å›¾
print(get_image_type(color))   # å½©è‰²å›¾ (3é€šé“)
```

---

## ğŸ¯ æ€»ç»“

æœ¬èŠ‚å­¦ä¹ äº† NumPy æ•°ç»„çš„ç´¢å¼•ä¸åˆ‡ç‰‡æ“ä½œï¼š

âœ… **ä¸€ç»´ç´¢å¼•**ï¼šæ­£ç´¢å¼• `[0]`ã€è´Ÿç´¢å¼• `[-1]`ã€åˆ‡ç‰‡ `[2:5]`
âœ… **äºŒç»´ç´¢å¼•**ï¼š`image[è¡Œ, åˆ—]`ã€è¡Œåˆ‡ç‰‡ã€åˆ—åˆ‡ç‰‡ã€çŸ©å½¢åŒºåŸŸ `[y1:y2, x1:x2]`
âœ… **ä¸‰ç»´ç´¢å¼•**ï¼šé¢œè‰²é€šé“ `[:,:,0]`ã€é€šé“åˆ†ç¦»ã€BGRâ†”RGB è½¬æ¢
âœ… **å¸ƒå°”ç´¢å¼•**ï¼šæ¡ä»¶ç­›é€‰ `arr[arr > 100]`ã€å¤šæ¡ä»¶ `&`/`|`/`~`ã€é˜ˆå€¼å¤„ç†
âœ… **èŠ±å¼ç´¢å¼•**ï¼šæ•´æ•°æ•°ç»„ç´¢å¼•ã€`np.where()` æ¡ä»¶ç´¢å¼•
âœ… **è§†å›¾ vs å‰¯æœ¬**ï¼šåˆ‡ç‰‡æ˜¯è§†å›¾ï¼ˆå…±äº«å†…å­˜ï¼‰ï¼Œ`.copy()` åˆ›å»ºç‹¬ç«‹å‰¯æœ¬

> ğŸ”‘ **æ ¸å¿ƒè¦ç‚¹ï¼š** å›¾åƒè£å‰ª = `image[y1:y2, x1:x2]`ï¼ˆæ³¨æ„ y åœ¨å‰ x åœ¨åï¼ï¼‰ï¼Œé€šé“æ“ä½œ = `image[:,:,é€šé“å·]`ï¼Œé˜ˆå€¼å¤„ç† = å¸ƒå°”ç´¢å¼•ã€‚è¿™ä¸‰ä¸ªæ“ä½œåœ¨è®¡ç®—æœºè§†è§‰ä¸­å‡ ä¹æ— å¤„ä¸åœ¨ã€‚

**ä¸‹ä¸€æ­¥ï¼š**
ğŸ‘‰ [03 - æ•°ç»„è¿ç®—](../03-æ•°ç»„è¿ç®—/æ•°ç»„è¿ç®—.md)

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [NumPy å®˜æ–¹æ–‡æ¡£ - ç´¢å¼•](https://numpy.org/doc/stable/user/basics.indexing.html)
- [NumPy å®˜æ–¹æ–‡æ¡£ - å¸ƒå°”ç´¢å¼•](https://numpy.org/doc/stable/reference/arrays.indexing.html#boolean-array-indexing)
