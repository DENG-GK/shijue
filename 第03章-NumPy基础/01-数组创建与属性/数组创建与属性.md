# æ•°ç»„åˆ›å»ºä¸å±æ€§

> NumPy æ•°ç»„ï¼ˆndarrayï¼‰æ˜¯å›¾åƒæ•°æ®çš„æ ¸å¿ƒè¡¨ç¤ºå½¢å¼ã€‚ä¸€å¼ å›¾åƒåœ¨è®¡ç®—æœºé‡Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°å­—ç»„æˆçš„å¤šç»´æ•°ç»„â€”â€”ç†è§£äº† NumPyï¼Œä½ å°±ç†è§£äº†å›¾åƒçš„"éª¨æ¶"ã€‚

---

## ğŸ“– ç†è®ºéƒ¨åˆ†

### 1. ä¸ºä»€ä¹ˆéœ€è¦ NumPyï¼Ÿ

åœ¨ä¸Šä¸€ç« ï¼Œæˆ‘ä»¬å­¦äº† Python åˆ—è¡¨ï¼ˆlistï¼‰ã€‚åˆ—è¡¨è™½ç„¶çµæ´»ï¼Œä½†ç”¨æ¥åšå¤§é‡æ•°å€¼è®¡ç®—å°±å¤ªæ…¢äº†ï¼š

```python
# âŒ ç”¨ Python åˆ—è¡¨å¤„ç† 100 ä¸‡ä¸ªåƒç´ å€¼
pixels = list(range(1000000))
result = []
for p in pixels:
    result.append(p * 2)   # é€ä¸ªå¤„ç†ï¼Œéå¸¸æ…¢ï¼
```

```python
# âœ… ç”¨ NumPy æ•°ç»„ï¼Œä¸€è¡Œæå®šï¼Œå¿« 50 å€ä»¥ä¸Šï¼
import numpy as np
pixels = np.arange(1000000)
result = pixels * 2         # å‘é‡åŒ–è¿ç®—ï¼Œåº•å±‚ C è¯­è¨€æ‰§è¡Œ
```

**NumPy çš„ä¸‰å¤§ä¼˜åŠ¿ï¼š**

| ç‰¹æ€§ | Python åˆ—è¡¨ | NumPy æ•°ç»„ |
|------|------------|-----------|
| **é€Ÿåº¦** | æ…¢ï¼ˆé€ä¸ªå¤„ç†ï¼‰ | å¿« 10~100 å€ï¼ˆæ‰¹é‡å¤„ç†ï¼‰ |
| **å†…å­˜** | å ç”¨å¤§ï¼ˆæ¯ä¸ªå…ƒç´ éƒ½æ˜¯å¯¹è±¡ï¼‰ | å ç”¨å°ï¼ˆè¿ç»­å†…å­˜å—ï¼‰ |
| **åŠŸèƒ½** | åŸºç¡€æ“ä½œ | ä¸°å¯Œçš„æ•°å­¦/ç»Ÿè®¡/çº¿æ€§ä»£æ•°å‡½æ•° |

> ğŸ’¡ **é€šä¿—ç†è§£ï¼š** Python åˆ—è¡¨å°±åƒä¸€ä¸ªä¸ªç‹¬ç«‹çš„æŠ½å±‰ï¼Œå–ä¸œè¥¿è¦ä¸€ä¸ªä¸ªå¼€ã€‚NumPy æ•°ç»„å°±åƒä¸€æ•´æ’è¿ç»­çš„æ ¼å­ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ“ä½œä¸€æ•´æ’ã€‚

**å®‰è£… NumPyï¼š**

```bash
pip install numpy
```

**å¯¼å…¥çº¦å®šï¼š**

```python
import numpy as np   # çº¦å®šä¿—æˆçš„ç¼©å†™ï¼Œæ‰€æœ‰æ•™ç¨‹å’Œæ–‡æ¡£éƒ½ç”¨ np
```

---

### 2. å›¾åƒä¸æ•°ç»„çš„å…³ç³»ï¼ˆé‡è¦ï¼ï¼‰

åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œ**å›¾åƒå°±æ˜¯æ•°ç»„**ã€‚ç†è§£è¿™ä¸ªæ¦‚å¿µæ˜¯åé¢æ‰€æœ‰å†…å®¹çš„åŸºç¡€ã€‚

#### 2.1 ç°åº¦å›¾åƒ = äºŒç»´æ•°ç»„

ç°åº¦å›¾åƒçš„æ¯ä¸ªåƒç´ æ˜¯ä¸€ä¸ª 0~255 çš„æ•°å­—ï¼ˆ0=é»‘è‰²ï¼Œ255=ç™½è‰²ï¼‰ï¼š

```
ä¸€å¼  4x5 çš„ç°åº¦å›¾åƒåœ¨å†…å­˜ä¸­çš„æ ·å­ï¼š

è¡Œï¼ˆé«˜åº¦ï¼‰â†“    åˆ—ï¼ˆå®½åº¦ï¼‰â†’
              0åˆ—   1åˆ—   2åˆ—   3åˆ—   4åˆ—
    0è¡Œ  [   0,   50,  100,  150,  200 ]
    1è¡Œ  [  25,   75,  125,  175,  225 ]
    2è¡Œ  [  50,  100,  150,  200,  250 ]
    3è¡Œ  [ 255,  200,  150,  100,   50 ]

shape = (4, 5)  â†’  4è¡Œï¼ˆé«˜åº¦ï¼‰Ã— 5åˆ—ï¼ˆå®½åº¦ï¼‰
```

#### 2.2 å½©è‰²å›¾åƒ = ä¸‰ç»´æ•°ç»„

å½©è‰²å›¾åƒçš„æ¯ä¸ªåƒç´ æœ‰ 3 ä¸ªé€šé“ï¼ˆè“è‰²Bã€ç»¿è‰²Gã€çº¢è‰²Rï¼‰ï¼š

```
ä¸€å¼  4x5 çš„å½©è‰²å›¾åƒï¼š

shape = (4, 5, 3)  â†’  4è¡Œ Ã— 5åˆ— Ã— 3é€šé“

æ¯ä¸ªåƒç´  = [B, G, R]
æ¯”å¦‚ image[0, 0] = [255, 0, 0] è¡¨ç¤ºçº¯è“è‰²ï¼ˆOpenCV ç”¨ BGR é¡ºåºï¼ï¼‰
```

#### 2.3 å›¾åƒç±»å‹å¯¹ç…§è¡¨

| å›¾åƒç±»å‹ | æ•°ç»„ç»´åº¦ | shape | æ•°æ®ç±»å‹ | è¯´æ˜ |
|---------|---------|-------|---------|------|
| ç°åº¦å›¾ | 2D | `(H, W)` | `uint8` | æ¯åƒç´  1 ä¸ªå€¼ï¼ˆ0~255ï¼‰ |
| å½©è‰²å›¾ | 3D | `(H, W, 3)` | `uint8` | æ¯åƒç´  3 ä¸ªå€¼ï¼ˆBGRï¼‰ |
| å¸¦é€æ˜é€šé“ | 3D | `(H, W, 4)` | `uint8` | æ¯åƒç´  4 ä¸ªå€¼ï¼ˆBGRAï¼‰ |
| æµ®ç‚¹å›¾åƒ | 2D/3D | `(H, W)` ç­‰ | `float32` | å½’ä¸€åŒ–åï¼ˆ0.0~1.0ï¼‰ |
| æ‰¹é‡å›¾åƒ | 4D | `(N, H, W, 3)` | `uint8` | N å¼ å›¾åƒæ‰“åŒ… |

> âš ï¸ **æ³¨æ„é¡ºåºï¼** NumPy/OpenCV ä¸­å›¾åƒçš„å½¢çŠ¶æ˜¯ `(é«˜åº¦, å®½åº¦)`ï¼Œ**é«˜åº¦åœ¨å‰ï¼Œå®½åº¦åœ¨å**ï¼è¿™å’Œæ—¥å¸¸è¯´çš„"å®½Ã—é«˜"æ˜¯åè¿‡æ¥çš„ã€‚è¿™æ˜¯æ–°æ‰‹æœ€å®¹æ˜“ææ··çš„åœ°æ–¹ã€‚

---

### 3. æ•°ç»„åˆ›å»ºæ–¹æ³•

NumPy æä¾›äº†å¾ˆå¤šåˆ›å»ºæ•°ç»„çš„æ–¹å¼ï¼Œæˆ‘ä»¬æŒ‰ä½¿ç”¨é¢‘ç‡æ¥å­¦ä¹ ã€‚

#### 3.1 ä» Python åˆ—è¡¨åˆ›å»ºï¼šnp.array()

æœ€åŸºæœ¬çš„åˆ›å»ºæ–¹å¼â€”â€”æŠŠå·²æœ‰çš„æ•°æ®è½¬æˆæ•°ç»„ï¼š

```python
import numpy as np

# --- ä¸€ç»´æ•°ç»„ï¼ˆå‘é‡ï¼‰---
pixels = np.array([0, 50, 100, 150, 200, 255])
print(pixels)        # [  0  50 100 150 200 255]
print(type(pixels))  # <class 'numpy.ndarray'>

# --- äºŒç»´æ•°ç»„ï¼ˆçŸ©é˜µï¼Œç±»ä¼¼ç°åº¦å›¾åƒï¼‰---
image = np.array([
    [0,   50,  100],
    [150, 200, 255]
])
print(image)
# [[  0  50 100]
#  [150 200 255]]

# --- ä¸‰ç»´æ•°ç»„ï¼ˆç±»ä¼¼å½©è‰²å›¾åƒï¼‰---
# 2x2 çš„å½©è‰²å›¾åƒï¼Œæ¯ä¸ªåƒç´  3 ä¸ªé€šé“
color_img = np.array([
    [[255, 0, 0], [0, 255, 0]],     # ç¬¬0è¡Œï¼šè“è‰², ç»¿è‰²
    [[0, 0, 255], [255, 255, 255]]   # ç¬¬1è¡Œï¼šçº¢è‰², ç™½è‰²
])
print(color_img.shape)  # (2, 2, 3)
```

**æŒ‡å®šæ•°æ®ç±»å‹ï¼š**

```python
# å›¾åƒé€šå¸¸ç”¨ uint8ï¼ˆæ— ç¬¦å·8ä½æ•´æ•°ï¼ŒèŒƒå›´ 0~255ï¼‰
img = np.array([100, 200, 300], dtype=np.uint8)
print(img)   # [100 200  44]   æ³¨æ„ï¼š300 æº¢å‡ºäº†ï¼300-256=44

# æµ®ç‚¹æ•°ç»„ï¼ˆå½’ä¸€åŒ–å›¾åƒå¸¸ç”¨ï¼‰
normalized = np.array([0.0, 0.5, 1.0], dtype=np.float32)
print(normalized)   # [0.  0.5 1. ]
```

> âš ï¸ **uint8 æº¢å‡ºé™·é˜±ï¼š** `uint8` çš„èŒƒå›´æ˜¯ 0~255ã€‚è¶…è¿‡ 255 ä¼š"ç»•å›æ¥"ï¼ˆ300 â†’ 44ï¼‰ï¼Œä½äº 0 ä¹Ÿä¼šç»•ï¼ˆ-1 â†’ 255ï¼‰ã€‚è¿™åœ¨å›¾åƒè¿ç®—ä¸­æ˜¯å¸¸è§çš„å‘ï¼

#### 3.2 åˆ›å»ºå…¨é›¶æ•°ç»„ï¼šnp.zeros()

```python
# åˆ›å»ºä¸€å¼  480x640 çš„é»‘è‰²ç°åº¦å›¾åƒ
black_gray = np.zeros((480, 640), dtype=np.uint8)
print(black_gray.shape)  # (480, 640)
print(black_gray[0, 0])  # 0ï¼ˆé»‘è‰²ï¼‰

# åˆ›å»ºä¸€å¼  480x640 çš„é»‘è‰²å½©è‰²å›¾åƒ
black_color = np.zeros((480, 640, 3), dtype=np.uint8)
print(black_color.shape)  # (480, 640, 3)
```

> ğŸ’¡ **ä½•æ—¶ä½¿ç”¨ï¼š** å½“ä½ éœ€è¦ä¸€ä¸ªç©ºç™½ç”»å¸ƒæ¥ç»˜åˆ¶å›¾å½¢ã€æ ‡æ³¨æ£€æµ‹æ¡†æ—¶ï¼Œå…ˆåˆ›å»ºå…¨é›¶æ•°ç»„ã€‚

#### 3.3 åˆ›å»ºå…¨ä¸€æ•°ç»„ï¼šnp.ones()

```python
# åˆ›å»ºä¸€å¼ å…¨ç™½ç°åº¦å›¾åƒï¼ˆ255 = ç™½è‰²ï¼‰
white_image = np.ones((480, 640), dtype=np.uint8) * 255
print(white_image[0, 0])  # 255

# åˆ›å»ºæ©è†œï¼ˆmaskï¼‰ï¼Œåˆå§‹å€¼å…¨ä¸º 1
mask = np.ones((100, 100), dtype=np.uint8)
```

#### 3.4 åˆ›å»ºå¡«å……æŒ‡å®šå€¼çš„æ•°ç»„ï¼šnp.full()

```python
# åˆ›å»ºç°è‰²å›¾åƒï¼ˆ128 = ä¸­ç°è‰²ï¼‰
gray_image = np.full((480, 640), 128, dtype=np.uint8)
print(gray_image[0, 0])  # 128

# åˆ›å»ºçº¯çº¢è‰²å›¾åƒï¼ˆBGR æ ¼å¼ï¼‰
red_image = np.full((480, 640, 3), (0, 0, 255), dtype=np.uint8)
print(red_image[0, 0])   # [  0   0 255]ï¼ˆçº¯çº¢è‰²ï¼‰
```

#### 3.5 ç­‰å·®åºåˆ—ï¼šnp.arange() å’Œ np.linspace()

```python
# np.arange(start, stop, step) â€” ç±»ä¼¼ Python çš„ rangeï¼Œä½†è¿”å›æ•°ç»„
a = np.arange(0, 10, 2)
print(a)   # [0 2 4 6 8]

# ç”Ÿæˆ 0~255 çš„åƒç´ å€¼èŒƒå›´
pixel_range = np.arange(256)   # [0, 1, 2, ..., 255]
print(len(pixel_range))  # 256

# np.linspace(start, stop, num) â€” å‡åŒ€åˆ†æˆ num ä¸ªç‚¹ï¼ˆåŒ…å«ç«¯ç‚¹ï¼‰
b = np.linspace(0, 1, 5)
print(b)   # [0.   0.25 0.5  0.75 1.  ]

# ç”Ÿæˆå½’ä¸€åŒ–åçš„ç°åº¦çº§
gray_levels = np.linspace(0, 255, 8, dtype=np.uint8)
print(gray_levels)  # [  0  36  73 109 145 182 218 255]
```

**arange vs linspace åŒºåˆ«ï¼š**

| å‡½æ•° | å‚æ•°å«ä¹‰ | åŒ…å«ç»ˆç‚¹ï¼Ÿ | é€‚ç”¨åœºæ™¯ |
|------|---------|----------|---------|
| `arange(0, 10, 2)` | èµ·å§‹=0, ç»ˆæ­¢=10, æ­¥é•¿=2 | âŒ ä¸å« | çŸ¥é“æ­¥é•¿æ—¶ä½¿ç”¨ |
| `linspace(0, 1, 5)` | èµ·å§‹=0, ç»ˆæ­¢=1, ä¸ªæ•°=5 | âœ… åŒ…å« | çŸ¥é“ä¸ªæ•°æ—¶ä½¿ç”¨ |

#### 3.6 éšæœºæ•°ç»„ï¼ˆå›¾åƒæ¨¡æ‹Ÿå¸¸ç”¨ï¼ï¼‰

```python
# --- å‡åŒ€åˆ†å¸ƒéšæœºæ•° [0, 1) ---
random_float = np.random.rand(3, 4)     # 3è¡Œ4åˆ—ï¼Œå€¼åœ¨ [0, 1) ä¹‹é—´
print(random_float.shape)  # (3, 4)

# --- æ­£æ€åˆ†å¸ƒéšæœºæ•°ï¼ˆå‡å€¼0ï¼Œæ ‡å‡†å·®1ï¼‰---
noise = np.random.randn(3, 4)           # å¯èƒ½ä¸ºè´Ÿæ•°
print(noise)

# --- éšæœºæ•´æ•°ï¼ˆæœ€å¸¸ç”¨ï¼æ¨¡æ‹Ÿå›¾åƒï¼‰---
# ç”Ÿæˆä¸€å¼  256x256 çš„éšæœºç°åº¦å›¾åƒ
random_gray = np.random.randint(0, 256, size=(256, 256), dtype=np.uint8)
print(random_gray.shape)  # (256, 256)
print(random_gray.dtype)  # uint8

# ç”Ÿæˆä¸€å¼  256x256 çš„éšæœºå½©è‰²å›¾åƒ
random_color = np.random.randint(0, 256, size=(256, 256, 3), dtype=np.uint8)
print(random_color.shape)  # (256, 256, 3)

# --- è®¾ç½®éšæœºç§å­ï¼ˆä¿è¯ç»“æœå¯å¤ç°ï¼‰---
np.random.seed(42)
a = np.random.rand(3)
print(a)  # æ¯æ¬¡è¿è¡Œç»“æœéƒ½ä¸€æ ·ï¼
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆè¦è®¾ç½®éšæœºç§å­ï¼Ÿ** åœ¨åšå®éªŒæ—¶ï¼Œè®¾ç½® `np.random.seed(42)` å¯ä»¥ä¿è¯æ¯æ¬¡è¿è¡Œç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼Œæ–¹ä¾¿è°ƒè¯•å’Œå¯¹æ¯”ç»“æœã€‚

#### 3.7 åˆ›å»ºä¸å·²æœ‰æ•°ç»„ç›¸åŒå½¢çŠ¶/ç±»å‹çš„æ•°ç»„

```python
original = np.array([[1, 2, 3], [4, 5, 6]], dtype=np.uint8)

# åˆ›å»ºç›¸åŒå½¢çŠ¶çš„å…¨é›¶æ•°ç»„ï¼ˆå¸¸ç”¨äºåˆ›å»ºç»“æœå›¾åƒï¼‰
result = np.zeros_like(original)
print(result)
# [[0 0 0]
#  [0 0 0]]

# åˆ›å»ºç›¸åŒå½¢çŠ¶çš„å…¨ä¸€æ•°ç»„
mask = np.ones_like(original)

# åˆ›å»ºç›¸åŒå½¢çŠ¶çš„ç©ºæ•°ç»„ï¼ˆæœªåˆå§‹åŒ–ï¼Œå€¼éšæœºï¼‰
temp = np.empty_like(original)
```

> ğŸ’¡ **ä½•æ—¶ä½¿ç”¨ï¼š** å½“ä½ éœ€è¦ä¸€ä¸ªå’Œè¾“å…¥å›¾åƒå®Œå…¨ç›¸åŒå¤§å°å’Œç±»å‹çš„ç©ºç™½å›¾åƒæ¥å­˜å‚¨ç»“æœæ—¶ï¼Œ`np.zeros_like()` éå¸¸æ–¹ä¾¿ã€‚

#### 3.8 å•ä½çŸ©é˜µå’Œå¯¹è§’çŸ©é˜µ

```python
# å•ä½çŸ©é˜µï¼ˆå¯¹è§’çº¿ä¸º1ï¼Œå…¶ä½™ä¸º0ï¼‰
eye = np.eye(3)
print(eye)
# [[1. 0. 0.]
#  [0. 1. 0.]
#  [0. 0. 1.]]

# å¯¹è§’çŸ©é˜µ
diag = np.diag([1, 2, 3])
print(diag)
# [[1 0 0]
#  [0 2 0]
#  [0 0 3]]
```

> ğŸ’¡ **åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼š** å•ä½çŸ©é˜µç”¨äºå›¾åƒå˜æ¢çš„åˆå§‹åŒ–ï¼ˆå¦‚ä»¿å°„å˜æ¢çŸ©é˜µã€é€è§†å˜æ¢çŸ©é˜µç­‰ï¼‰ã€‚

---

### 4. æ•°ç»„å±æ€§è¯¦è§£

åˆ›å»ºæ•°ç»„åï¼Œäº†è§£å®ƒçš„å±æ€§éå¸¸é‡è¦â€”â€”ç‰¹åˆ«æ˜¯åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œä½ ç»å¸¸éœ€è¦çŸ¥é“å›¾åƒçš„å°ºå¯¸ã€é€šé“æ•°ã€æ•°æ®ç±»å‹ç­‰ã€‚

```python
import numpy as np

# æ¨¡æ‹Ÿä¸€å¼  480x640 çš„å½©è‰²å›¾åƒ
image = np.random.randint(0, 256, (480, 640, 3), dtype=np.uint8)
```

#### 4.1 æ ¸å¿ƒå±æ€§ä¸€è§ˆ

```python
# shape â€” å½¢çŠ¶ï¼ˆæœ€å¸¸ç”¨ï¼ï¼‰
print(image.shape)      # (480, 640, 3)
# å«ä¹‰ï¼šé«˜åº¦=480, å®½åº¦=640, é€šé“æ•°=3

# ä» shape ä¸­æå–å„ç»´åº¦
height, width, channels = image.shape
print(f"é«˜åº¦: {height}, å®½åº¦: {width}, é€šé“æ•°: {channels}")

# å¯¹äºç°åº¦å›¾åƒï¼ˆåªæœ‰2ä¸ªç»´åº¦ï¼‰
gray = np.zeros((480, 640), dtype=np.uint8)
print(gray.shape)   # (480, 640)
# å®‰å…¨åœ°è·å–é€šé“æ•°
h, w = gray.shape[:2]   # å–å‰ä¸¤ä¸ªç»´åº¦ï¼Œä¸ç®¡æ˜¯ç°åº¦è¿˜æ˜¯å½©è‰²éƒ½èƒ½ç”¨
channels = gray.shape[2] if gray.ndim == 3 else 1
print(f"é€šé“æ•°: {channels}")  # 1
```

```python
# ndim â€” ç»´åº¦æ•°
print(image.ndim)   # 3ï¼ˆä¸‰ç»´ï¼šé«˜Ã—å®½Ã—é€šé“ï¼‰
print(gray.ndim)    # 2ï¼ˆäºŒç»´ï¼šé«˜Ã—å®½ï¼‰
```

```python
# dtype â€” æ•°æ®ç±»å‹
print(image.dtype)   # uint8ï¼ˆæ— ç¬¦å·8ä½æ•´æ•°ï¼Œ0~255ï¼‰
```

```python
# size â€” å…ƒç´ æ€»æ•°
print(image.size)    # 480 * 640 * 3 = 921,600

# itemsize â€” æ¯ä¸ªå…ƒç´ å ç”¨çš„å­—èŠ‚æ•°
print(image.itemsize)  # 1ï¼ˆuint8 å 1å­—èŠ‚ï¼‰

# nbytes â€” æ•°ç»„æ€»å†…å­˜å¤§å°ï¼ˆå­—èŠ‚ï¼‰
print(image.nbytes)    # 921,600 å­—èŠ‚ â‰ˆ 0.88 MB
print(f"å†…å­˜å ç”¨: {image.nbytes / 1024 / 1024:.2f} MB")
```

#### 4.2 å¸¸è§æ•°æ®ç±»å‹

åœ¨å›¾åƒå¤„ç†ä¸­ï¼Œé€‰æ‹©æ­£ç¡®çš„æ•°æ®ç±»å‹éå¸¸é‡è¦ï¼š

| NumPy ç±»å‹ | ç®€å†™ | èŒƒå›´ | å­—èŠ‚ | å…¸å‹ç”¨é€” |
|-----------|------|------|------|---------|
| `np.uint8` | `u1` | 0 ~ 255 | 1 | **å›¾åƒåƒç´ å€¼**ï¼ˆæœ€å¸¸ç”¨ï¼ï¼‰ |
| `np.int32` | `i4` | -2Â³Â¹ ~ 2Â³Â¹-1 | 4 | åæ ‡ã€ç´¢å¼• |
| `np.float32` | `f4` | Â±3.4Ã—10Â³â¸ | 4 | **å½’ä¸€åŒ–å›¾åƒã€æ¨¡å‹æƒé‡** |
| `np.float64` | `f8` | Â±1.8Ã—10Â³â°â¸ | 8 | é«˜ç²¾åº¦è®¡ç®— |
| `np.bool_` | `?` | True/False | 1 | æ©è†œï¼ˆmaskï¼‰ |

```python
# ç±»å‹è½¬æ¢ï¼ˆå›¾åƒå¤„ç†ä¸­éå¸¸å¸¸ç”¨ï¼ï¼‰
img_uint8 = np.array([100, 200, 50], dtype=np.uint8)

# uint8 â†’ float32ï¼ˆå½’ä¸€åŒ–å‰å¸¸åšçš„æ“ä½œï¼‰
img_float = img_uint8.astype(np.float32) / 255.0
print(img_float)        # [0.392 0.784 0.196]
print(img_float.dtype)  # float32

# float32 â†’ uint8ï¼ˆä¿å­˜å›¾åƒå‰å¸¸åšçš„æ“ä½œï¼‰
img_back = (img_float * 255).astype(np.uint8)
print(img_back)         # [100 200  50]
print(img_back.dtype)   # uint8
```

> âš ï¸ **ç±»å‹è½¬æ¢çš„å‘ï¼š** `astype()` ä¸ä¼šè‡ªåŠ¨è£å‰ªèŒƒå›´ï¼å¦‚æœ float å€¼è¶…è¿‡ 255 æˆ–å°äº 0ï¼Œè½¬ uint8 ä¼šæº¢å‡ºã€‚æ‰€ä»¥è½¬æ¢å‰ä¸€å®šè¦å…ˆç”¨ `np.clip()` è£å‰ªï¼š
> ```python
> values = np.array([300.0, -50.0, 128.0])
> safe = np.clip(values, 0, 255).astype(np.uint8)
> print(safe)  # [255   0 128]   æ­£ç¡®ï¼
> ```

---

### 5. æ•°ç»„ vs åˆ—è¡¨ï¼šå…³é”®åŒºåˆ«

åˆå­¦è€…å®¹æ˜“æ··æ·† NumPy æ•°ç»„å’Œ Python åˆ—è¡¨ã€‚ä¸‹é¢ç”¨å¯¹æ¯”æ¥è¯´æ¸…æ¥šå®ƒä»¬çš„åŒºåˆ«ï¼š

#### 5.1 è¿ç®—è¡Œä¸ºä¸åŒ

```python
# Python åˆ—è¡¨ï¼š+ æ˜¯æ‹¼æ¥ï¼Œ* æ˜¯é‡å¤
list_a = [1, 2, 3]
list_b = [4, 5, 6]
print(list_a + list_b)   # [1, 2, 3, 4, 5, 6]ï¼ˆæ‹¼æ¥ï¼‰
print(list_a * 3)        # [1, 2, 3, 1, 2, 3, 1, 2, 3]ï¼ˆé‡å¤ï¼‰

# NumPy æ•°ç»„ï¼š+ æ˜¯é€å…ƒç´ åŠ æ³•ï¼Œ* æ˜¯é€å…ƒç´ ä¹˜æ³•
arr_a = np.array([1, 2, 3])
arr_b = np.array([4, 5, 6])
print(arr_a + arr_b)     # [5 7 9]ï¼ˆé€å…ƒç´ ç›¸åŠ ï¼‰
print(arr_a * 3)         # [3 6 9]ï¼ˆæ¯ä¸ªå…ƒç´ Ã—3ï¼‰
```

#### 5.2 ç±»å‹çº¦æŸä¸åŒ

```python
# Python åˆ—è¡¨ï¼šå¯ä»¥æ··åˆç±»å‹
mixed_list = [1, "hello", 3.14, True]   # âœ… æ²¡é—®é¢˜

# NumPy æ•°ç»„ï¼šæ‰€æœ‰å…ƒç´ å¿…é¡»åŒä¸€ç±»å‹
arr = np.array([1, 2, 3.14])
print(arr.dtype)   # float64ï¼ˆæ•´æ•°è¢«è‡ªåŠ¨è½¬ä¸ºæµ®ç‚¹æ•°ï¼‰
print(arr)         # [1.   2.   3.14]
```

#### 5.3 æ€§èƒ½å¯¹æ¯”

```python
import time

size = 1_000_000

# Python åˆ—è¡¨è¿ç®—
py_list = list(range(size))
start = time.time()
result_list = [x * 2 for x in py_list]
py_time = time.time() - start

# NumPy æ•°ç»„è¿ç®—
np_arr = np.arange(size)
start = time.time()
result_arr = np_arr * 2
np_time = time.time() - start

print(f"Python åˆ—è¡¨: {py_time:.4f} ç§’")
print(f"NumPy æ•°ç»„:  {np_time:.4f} ç§’")
print(f"NumPy å¿«äº†:  {py_time / np_time:.0f} å€")
# å…¸å‹ç»“æœï¼šNumPy å¿« 50~100 å€
```

> ğŸ’¡ **ä¸ºä»€ä¹ˆ NumPy è¿™ä¹ˆå¿«ï¼Ÿ**
> 1. **åº•å±‚ç”¨ C è¯­è¨€å®ç°**ï¼Œè·³è¿‡äº† Python çš„è§£é‡Šå™¨å¼€é”€
> 2. **è¿ç»­å†…å­˜å­˜å‚¨**ï¼Œå¯¹ CPU ç¼“å­˜å‹å¥½
> 3. **å‘é‡åŒ–æ“ä½œ**ï¼Œä¸€æ¡æŒ‡ä»¤å¤„ç†å¤šä¸ªæ•°æ®ï¼ˆSIMDï¼‰

---

## ğŸ’» ä»£ç å®æˆ˜

### å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒæ•°æ®æ¢ç´¢å™¨

```python
# ===================================================================
# å®æˆ˜ç»ƒä¹ ï¼šå›¾åƒæ•°æ®æ¢ç´¢å™¨
# ç›®æ ‡ï¼šç»¼åˆè¿ç”¨æ•°ç»„åˆ›å»ºå’Œå±æ€§æŸ¥çœ‹
# ===================================================================

import numpy as np

# ---------- 1. åˆ›å»ºå„ç§"å›¾åƒ" ----------
print("=" * 55)
print("ğŸ¨ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¨¡æ‹Ÿå›¾åƒ")
print("=" * 55)

# é»‘è‰²ç°åº¦å›¾
black_gray = np.zeros((100, 150), dtype=np.uint8)
print(f"  é»‘è‰²ç°åº¦å›¾: shape={black_gray.shape}, dtype={black_gray.dtype}")

# ç™½è‰²ç°åº¦å›¾
white_gray = np.ones((100, 150), dtype=np.uint8) * 255
print(f"  ç™½è‰²ç°åº¦å›¾: shape={white_gray.shape}, æœ€å¤§å€¼={white_gray.max()}")

# ç°è‰²å›¾åƒ
gray_50 = np.full((100, 150), 128, dtype=np.uint8)
print(f"  50%ç°åº¦å›¾:  shape={gray_50.shape}, åƒç´ å€¼={gray_50[0,0]}")

# éšæœºå™ªå£°å›¾
np.random.seed(42)
noise = np.random.randint(0, 256, (100, 150), dtype=np.uint8)
print(f"  éšæœºå™ªå£°å›¾: shape={noise.shape}, å‡å€¼={noise.mean():.1f}")

# æ¸å˜å›¾åƒï¼ˆä»é»‘åˆ°ç™½ï¼‰
gradient = np.tile(np.linspace(0, 255, 150, dtype=np.uint8), (100, 1))
print(f"  æ°´å¹³æ¸å˜å›¾: shape={gradient.shape}")
print(f"    å·¦è¾¹={gradient[0, 0]}, ä¸­é—´={gradient[0, 75]}, å³è¾¹={gradient[0, 149]}")

# çº¯è‰²å½©è‰²å›¾
blue_img = np.zeros((100, 150, 3), dtype=np.uint8)
blue_img[:, :, 0] = 255   # Bé€šé“è®¾ä¸º255 â†’ çº¯è“è‰²
print(f"  çº¯è“å½©è‰²å›¾: shape={blue_img.shape}, åƒç´ ={blue_img[0,0]}")

# ---------- 2. æŸ¥çœ‹å›¾åƒå±æ€§ ----------
print("\n" + "=" * 55)
print("ğŸ“Š ç¬¬äºŒæ­¥ï¼šå›¾åƒå±æ€§åˆ†æ")
print("=" * 55)

images = {
    "ç°åº¦å›¾": black_gray,
    "å½©è‰²å›¾": blue_img,
    "å™ªå£°å›¾": noise,
    "æ¸å˜å›¾": gradient,
}

print(f"\n  {'åç§°':ã€€<8s}  {'shape':ã€€<16s}  {'ndim':>4s}  {'dtype':>8s}  "
      f"{'size':>8s}  {'å†…å­˜(KB)':>8s}")
print("  " + "-" * 62)

for name, img in images.items():
    print(f"  {name:ã€€<8s}  {str(img.shape):ã€€<16s}  {img.ndim:>4d}  "
          f"{str(img.dtype):>8s}  {img.size:>8,}  {img.nbytes/1024:>8.1f}")

# ---------- 3. æ•°æ®ç±»å‹è½¬æ¢å®æˆ˜ ----------
print("\n" + "=" * 55)
print("ğŸ”„ ç¬¬ä¸‰æ­¥ï¼šæ•°æ®ç±»å‹è½¬æ¢")
print("=" * 55)

# æ¨¡æ‹Ÿå›¾åƒäº®åº¦å¢å¼ºï¼ˆéœ€è¦ç±»å‹è½¬æ¢é¿å…æº¢å‡ºï¼‰
original = np.array([200, 220, 240, 100, 50], dtype=np.uint8)
print(f"\n  åŸå§‹åƒç´  (uint8):  {original}")

# âŒ ç›´æ¥åŠ  â€”â€” æº¢å‡ºï¼
wrong_result = original + np.uint8(80)
print(f"  ç›´æ¥åŠ 80 (æº¢å‡º!):  {wrong_result}")  # 200+80=280â†’24

# âœ… å…ˆè½¬ floatï¼Œè®¡ç®—åè£å‰ªå› uint8
correct = original.astype(np.float32) + 80
correct = np.clip(correct, 0, 255).astype(np.uint8)
print(f"  å®‰å…¨åŠ 80 (æ­£ç¡®):  {correct}")

# ---------- 4. åˆ›å»ºæ–¹æ³•é€ŸæŸ¥ ----------
print("\n" + "=" * 55)
print("ğŸ“‹ ç¬¬å››æ­¥ï¼šåˆ›å»ºæ–¹æ³•æ€»ç»“")
print("=" * 55)

creation_demo = {
    "np.zeros((3,4))":       np.zeros((3, 4)),
    "np.ones((2,3))":        np.ones((2, 3)),
    "np.full((2,3), 7)":     np.full((2, 3), 7),
    "np.eye(3)":             np.eye(3),
    "np.arange(0,10,2)":     np.arange(0, 10, 2),
    "np.linspace(0,1,5)":    np.linspace(0, 1, 5),
}

for expr, arr in creation_demo.items():
    shape_str = str(arr.shape)
    print(f"  {expr:<25s} â†’ shape={shape_str:<10s} dtype={arr.dtype}")
```

**è¿è¡Œè¾“å‡ºç¤ºä¾‹ï¼š**

```
=======================================================
ğŸ¨ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ¨¡æ‹Ÿå›¾åƒ
=======================================================
  é»‘è‰²ç°åº¦å›¾: shape=(100, 150), dtype=uint8
  ç™½è‰²ç°åº¦å›¾: shape=(100, 150), æœ€å¤§å€¼=255
  50%ç°åº¦å›¾:  shape=(100, 150), åƒç´ å€¼=128
  éšæœºå™ªå£°å›¾: shape=(100, 150), å‡å€¼=127.3
  æ°´å¹³æ¸å˜å›¾: shape=(100, 150)
    å·¦è¾¹=0, ä¸­é—´=127, å³è¾¹=255
  çº¯è“å½©è‰²å›¾: shape=(100, 150, 3), åƒç´ =[255   0   0]

=======================================================
ğŸ“Š ç¬¬äºŒæ­¥ï¼šå›¾åƒå±æ€§åˆ†æ
=======================================================

  åç§°       shape             ndim     dtype      size   å†…å­˜(KB)
  ----------------------------------------------------------------
  ç°åº¦å›¾     (100, 150)           2     uint8    15,000      14.6
  å½©è‰²å›¾     (100, 150, 3)        3     uint8    45,000      43.9
  å™ªå£°å›¾     (100, 150)           2     uint8    15,000      14.6
  æ¸å˜å›¾     (100, 150)           2     uint8    15,000      14.6

=======================================================
ğŸ”„ ç¬¬ä¸‰æ­¥ï¼šæ•°æ®ç±»å‹è½¬æ¢
=======================================================

  åŸå§‹åƒç´  (uint8):  [200 220 240 100  50]
  ç›´æ¥åŠ 80 (æº¢å‡º!):  [ 24  44  64 180 130]
  å®‰å…¨åŠ 80 (æ­£ç¡®):  [255 255 255 180 130]
```

---

## ğŸš¨ å¸¸è§é—®é¢˜ä¸æ˜“é”™ç‚¹

### Q1: shape çš„ (é«˜åº¦, å®½åº¦) é¡ºåºæ€»æ˜¯æåæ€ä¹ˆåŠï¼Ÿ

```python
# è®°ä½å£è¯€ï¼šNumPy æ˜¯ "è¡Œåˆ—" é¡ºåº = "é«˜å®½" é¡ºåº
image = np.zeros((480, 640, 3))  # 480è¡Œ(é«˜) Ã— 640åˆ—(å®½) Ã— 3é€šé“

# ä½† OpenCV çš„ resize å‚æ•°æ˜¯ (å®½, é«˜)ï¼è¦æ³¨æ„ï¼
# cv2.resize(image, (new_width, new_height))  â† æ³¨æ„è¿™é‡Œæ˜¯å®½åœ¨å‰

# å®‰å…¨çš„å†™æ³•ï¼š
h, w = image.shape[:2]    # ä» shape ä¸­å–é«˜å’Œå®½
print(f"é«˜åº¦: {h}, å®½åº¦: {w}")
```

### Q2: uint8 æº¢å‡ºå¯¼è‡´å›¾åƒæ˜¾ç¤ºå¼‚å¸¸ï¼Ÿ

```python
# é—®é¢˜ï¼šä¸¤å¼ å›¾åƒç›¸åŠ å¯èƒ½æº¢å‡º
img1 = np.array([[200, 100]], dtype=np.uint8)
img2 = np.array([[100, 200]], dtype=np.uint8)

# âŒ NumPy ç›´æ¥åŠ æ³•ä¼šæº¢å‡ºï¼ˆ200+100=300â†’44ï¼‰
wrong = img1 + img2
print(wrong)   # [[44, 44]]

# âœ… æ–¹æ³•1ï¼šä½¿ç”¨ np.clip
safe = np.clip(img1.astype(np.int16) + img2.astype(np.int16), 0, 255).astype(np.uint8)
print(safe)    # [[255, 255]]

# âœ… æ–¹æ³•2ï¼šä½¿ç”¨ OpenCV çš„ addï¼ˆè‡ªåŠ¨è£å‰ªåˆ° 0~255ï¼‰
# import cv2
# safe = cv2.add(img1, img2)
```

### Q3: åˆ›å»ºæ•°ç»„æ—¶ä»€ä¹ˆæ—¶å€™éœ€è¦æŒ‡å®š dtypeï¼Ÿ

```python
# ä¸æŒ‡å®šæ—¶ï¼ŒNumPy ä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹
a = np.array([1, 2, 3])        # â†’ int64ï¼ˆæ•´æ•°é»˜è®¤ int64ï¼‰
b = np.array([1.0, 2.0, 3.0])  # â†’ float64ï¼ˆæµ®ç‚¹é»˜è®¤ float64ï¼‰

# å›¾åƒå¤„ç†ä¸­å»ºè®®æ˜¾å¼æŒ‡å®šï¼š
img = np.zeros((480, 640), dtype=np.uint8)       # å›¾åƒå¿…é¡» uint8
weight = np.ones((3, 3), dtype=np.float32)        # å·ç§¯æ ¸ç”¨ float32

# ä¸æŒ‡å®š dtype çš„åæœï¼šé»˜è®¤ float64 å  8 å­—èŠ‚ï¼Œuint8 åªå  1 å­—èŠ‚
# ä¸€å¼  1080p å½©è‰²å›¾åƒçš„å†…å­˜å·®å¼‚ï¼š
# float64: 1080 Ã— 1920 Ã— 3 Ã— 8 = 47.5 MB
# uint8:   1080 Ã— 1920 Ã— 3 Ã— 1 = 5.9 MBï¼ˆå·® 8 å€ï¼ï¼‰
```

### Q4: np.zeros() å’Œ np.empty() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

```python
# zeros â†’ æ‰€æœ‰å…ƒç´ åˆå§‹åŒ–ä¸º 0ï¼ˆå®‰å…¨ï¼Œæ¨èï¼‰
a = np.zeros((2, 3))
print(a)   # å…¨æ˜¯ 0

# empty â†’ ä¸åˆå§‹åŒ–ï¼Œå€¼æ˜¯éšæœºçš„å†…å­˜æ®‹ç•™ï¼ˆå¿«ï¼Œä½†ä¸å®‰å…¨ï¼‰
b = np.empty((2, 3))
print(b)   # éšæœºå€¼ï¼

# å»ºè®®ï¼šé™¤éå¯¹æ€§èƒ½æåº¦æ•æ„Ÿï¼Œå¦åˆ™éƒ½ç”¨ zeros
```

---

## ğŸ¯ æ€»ç»“

æœ¬èŠ‚å­¦ä¹ äº† NumPy æ•°ç»„çš„åˆ›å»ºå’Œå±æ€§ï¼š

âœ… **å›¾åƒä¸æ•°ç»„å…³ç³»**ï¼šç°åº¦å›¾=2Dæ•°ç»„ `(H,W)`ï¼Œå½©è‰²å›¾=3Dæ•°ç»„ `(H,W,3)`
âœ… **åˆ›å»ºæ–¹æ³•**ï¼š`array`ã€`zeros`ã€`ones`ã€`full`ã€`arange`ã€`linspace`ã€`random`
âœ… **æ ¸å¿ƒå±æ€§**ï¼š`shape`ï¼ˆå½¢çŠ¶ï¼‰ã€`dtype`ï¼ˆç±»å‹ï¼‰ã€`ndim`ï¼ˆç»´åº¦ï¼‰ã€`size`ï¼ˆå…ƒç´ æ•°ï¼‰
âœ… **æ•°æ®ç±»å‹**ï¼šå›¾åƒç”¨ `uint8`ï¼ˆ0~255ï¼‰ï¼Œè®¡ç®—ç”¨ `float32`
âœ… **ç±»å‹è½¬æ¢**ï¼š`astype()` è½¬æ¢ç±»å‹ï¼Œ`np.clip()` é˜²æº¢å‡º
âœ… **æ•°ç»„ vs åˆ—è¡¨**ï¼šè¿ç®—è¡Œä¸ºä¸åŒï¼ˆé€å…ƒç´  vs æ‹¼æ¥ï¼‰ï¼ŒNumPy å¿« 50~100 å€

> ğŸ”‘ **æ ¸å¿ƒè¦ç‚¹ï¼š** åœ¨è®¡ç®—æœºè§†è§‰ä¸­ï¼Œå›¾åƒå°±æ˜¯ NumPy æ•°ç»„ã€‚`shape` å‘Šè¯‰ä½ å›¾åƒçš„é«˜å®½é€šé“ï¼Œ`dtype` å†³å®šäº†åƒç´ å€¼çš„èŒƒå›´å’Œå†…å­˜å ç”¨ã€‚æ¯æ¬¡æ‹¿åˆ°ä¸€å¼ å›¾åƒï¼Œç¬¬ä¸€ä»¶äº‹å°±æ˜¯æ‰“å° `shape` å’Œ `dtype`ï¼

**ä¸‹ä¸€æ­¥ï¼š**
ğŸ‘‰ [02 - æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡](../02-æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡/æ•°ç»„ç´¢å¼•ä¸åˆ‡ç‰‡.md)

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [NumPy å®˜æ–¹æ–‡æ¡£ - æ•°ç»„åˆ›å»º](https://numpy.org/doc/stable/user/basics.creation.html)
- [NumPy å®˜æ–¹æ–‡æ¡£ - æ•°æ®ç±»å‹](https://numpy.org/doc/stable/reference/arrays.dtypes.html)
- [NumPy ä¸­æ–‡æ–‡æ¡£](https://www.numpy.org.cn/)
